(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c5cdd52"],{"1a68":function(t,e,i){"use strict";i.d(e,"d",(function(){return a})),i.d(e,"c",(function(){return n})),i.d(e,"a",(function(){return o})),i.d(e,"e",(function(){return r})),i.d(e,"b",(function(){return c}));var s=i("b775");function a(t){return Object(s["a"])({url:"/visits",method:"get",params:t})}function n(t){return Object(s["a"])({url:"/visits/".concat(t),method:"get"})}function o(t){return Object(s["a"])({url:"/visits",method:"post",data:t})}function r(t,e){return Object(s["a"])({url:"/visits/".concat(t),method:"put",data:e})}function c(t){return Object(s["a"])({url:"/visits/".concat(t),method:"delete"})}},e65a:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{staticClass:"px-4 py-0",attrs:{fluid:""},scopedSlots:t._u([{key:"after-heading",fn:function(){},proxy:!0}])},[i("v-row",{staticClass:"d-flex justify-space-between mx-1 mb-0"},[i("div",[i("v-row",[i("v-switch",{staticClass:"mx-3",staticStyle:{"max-width":"100px"},attrs:{label:"倒序"},model:{value:t.listQuery.orderby_id_desc,callback:function(e){t.$set(t.listQuery,"orderby_id_desc",e)},expression:"listQuery.orderby_id_desc"}}),i("v-select",{staticClass:"mx-3",staticStyle:{"max-width":"80px"},attrs:{items:t.customerOptions,"item-text":"display_name","item-value":"key","menu-props":"auto","hide-details":"",label:"客户名称","single-line":""},model:{value:t.listQuery.customer_id,callback:function(e){t.$set(t.listQuery,"customer_id",e)},expression:"listQuery.customer_id"}}),i("v-text-field",{staticClass:"mx-3",staticStyle:{"max-width":"120px"},attrs:{label:"姓名","hide-details":"","single-line":""},model:{value:t.listQuery.keyword,callback:function(e){t.$set(t.listQuery,"keyword",e)},expression:"listQuery.keyword"}})],1)],1),i("div",[i("v-row",{staticClass:"mx-2"},[i("v-btn",{staticClass:"mx-1 my-2",attrs:{color:"primary"},on:{click:t.getQuery}},[t._v(" 查询 "),i("v-icon",{attrs:{right:""}},[t._v("mdi-magnify")])],1),i("v-btn",{staticClass:"mx-1 mx-1 my-2",attrs:{color:"primary"},on:{click:t.resetQuery}},[t._v(" 重置 "),i("v-icon",{attrs:{right:""}},[t._v("mdi-lock-reset")])],1),i("export-excel",{attrs:{fields:t.exportFields,worksheet:"签约数据",name:"九色鹿抽签签约数据.xls",fetch:t.getListforExport}},[i("v-btn",{staticClass:"mx-1 mx-1 my-2",attrs:{color:"primary"}},[t._v(" 导出 "),i("v-icon",{attrs:{right:""}},[t._v("mdi-arrow-down-bold-circle-outline")])],1)],1),i("div",[i("add-visit-dialog")],1)],1)],1)]),i("v-simple-table",{staticClass:"pa-3",attrs:{"fixed-header":"",height:"735px"},scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th",[t._v("ID")]),i("th",[t._v("档案编号")]),i("th",[t._v("标题")]),i("th",[t._v("公司(单位)名称")]),i("th",[t._v("拜访日志")]),i("th",[t._v("创建者")]),i("th",[t._v("状态")]),i("th",[t._v("创建时间")]),i("th",[t._v("最后编辑")])])]),i("tbody",t._l(t.items,(function(e){return i("tr",{key:e.id},[i("td",{staticClass:"font-weight-light grey--text text-left",staticStyle:{"font-size":"11px"}},[t._v(" "+t._s(e.id)+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(e.document_code)+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t._f("truncate")(e.title,15))+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t._f("truncate")(e.customer_name,15))+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t._f("truncate")(e.description,40))+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(e.author.name)+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t.getNamefromOptions(t.statusCodes,e.status_code))+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t.$moment(e.create_at).format("YYYY-MM-DD HH:mm"))+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t.$moment(e.last_update).format("YYYY-MM-DD HH:mm"))+" "),i("v-btn",{attrs:{color:t.icons.doc.color,icon:"",fab:"","x-small":""},on:{click:function(i){return t.handleToDetails(e)}}},[i("v-icon",{attrs:{right:""},domProps:{textContent:t._s(t.icons.doc.icon)}})],1),t.isAuthor(e.author_id)&&0===e.status_code?i("v-btn",{attrs:{color:t.icons.delete.color,icon:"",fab:"","x-small":""},on:{click:function(i){return t.removeVisit(e)}}},[i("v-icon",{attrs:{right:""},domProps:{textContent:t._s(t.icons.delete.icon)}})],1):t._e()],1)])})),0)]},proxy:!0}])}),i("v-pagination",{staticClass:"my-3",attrs:{circle:t.circle,disabled:t.disabled,length:t.total_pages,"next-icon":t.nextIcon,"prev-icon":t.prevIcon,"total-visible":t.totalVisible,value:t.listQuery.page},on:{input:t.paginationChangeHandler},model:{value:t.listQuery.page,callback:function(e){t.$set(t.listQuery,"page",e)},expression:"listQuery.page"}}),i("v-snackbar",{attrs:{timeout:t.timeout},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.text)+" ")])],1)},a=[],n=(i("4160"),i("d3b7"),i("159b"),i("1a68")),o=[{key:0,display_name:"新建"},{key:1,display_name:"提审"},{key:3,display_name:"完成"},{key:9,display_name:"驳回"}],r={name:"Visits",components:{AddVisitDialog:function(){return i.e("chunk-0fe9e3ad").then(i.bind(null,"89ea9"))}},data:function(){return{statusCodes:o,snackbar:!1,text:"",timeout:3e3,panel:[0,1],icons:{doc:{color:"blue",icon:"mdi-file-document"},delete:{color:"warning",icon:"mdi-trash-can"}},exportFields:{},items:[],listQuery:{page:1,limit:10,keyword:void 0,activity:void 0,batch_code:void 0,sort:"+id",orderby_id_desc:void 0},search:"",awaitingSearch:!1,circle:!0,disabled:!1,length:10,nextIcon:"mdi-chevron-right",prevIcon:"mdi-chevron-left",totalVisible:10,total_pages:0,customerOptions:[]}},computed:{isAdminRole:function(){return"administrator"===this.$store.getters.role.slug}},created:function(){this.getList(),console.log(Date.now())},methods:{getQuery:function(){this.listQuery.page=1,this.getList()},isAuthor:function(t){var e=this.$store.getters.userId;return e===t},getList:function(){var t=this;this.listLoading=!0,this.listQuery.limit=10,Object(n["d"])(this.listQuery).then((function(e){t.items=e.data.items,t.total_pages=e.data._meta.total_pages,setTimeout((function(){t.listLoading=!1}),1500)}))},getListforExport:function(){var t=this;return this.listLoading=!0,this.listQuery.limit=1e4,Object(n["d"])(this.listQuery).then((function(e){t.exportItems=e.data.items,setTimeout((function(){t.listLoading=!1}),1500)})),this.exportItems},resetQuery:function(){this.listQuery.keyword=void 0,this.listQuery.batch_code=void 0,this.listQuery.limit=10},removeVisit:function(t){var e=this;this.$confirm("确认删除拜访日志?").then((function(i){i&&Object(n["b"])(t.id).then((function(t){e.getList(),e.text="拜访日志删除成功！",e.snackbar=!0}))}))},handleToDetails:function(t){this.$router.push({name:"VisitDetails",params:{id:t.id}})},getNamefromOptions:function(t,e){var i="";return t.forEach((function(t){t.key===e&&(i=t.display_name)})),i},paginationChangeHandler:function(t){this.listQuery.page=t,this.getList()}}},c=r,l=(i("f691"),i("2877")),d=i("6544"),u=i.n(d),m=i("8336"),f=i("a523"),h=i("132d"),v=i("891e"),p=i("0fd9"),_=i("b974"),y=i("1f4f"),b=i("2db4"),x=i("b73d"),g=i("8654"),k=Object(l["a"])(c,s,a,!1,null,"470b693b",null);e["default"]=k.exports;u()(k,{VBtn:m["a"],VContainer:f["a"],VIcon:h["a"],VPagination:v["a"],VRow:p["a"],VSelect:_["a"],VSimpleTable:y["a"],VSnackbar:b["a"],VSwitch:x["a"],VTextField:g["a"]})},ec03:function(t,e,i){},f691:function(t,e,i){"use strict";var s=i("ec03"),a=i.n(s);a.a}}]);
//# sourceMappingURL=chunk-7c5cdd52.a9879fd8.js.map