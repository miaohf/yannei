(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f4abe86"],{"21dd":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{staticClass:"px-4 py-0",attrs:{fluid:""},scopedSlots:t._u([{key:"after-heading",fn:function(){},proxy:!0}])},[i("v-row",{staticClass:"d-flex justify-space-between mx-1"},[i("div",[i("v-row",[i("v-switch",{staticClass:"mx-3",staticStyle:{"max-width":"100px"},attrs:{label:"倒序"},model:{value:t.listQuery.orderby_id_desc,callback:function(e){t.$set(t.listQuery,"orderby_id_desc",e)},expression:"listQuery.orderby_id_desc"}}),i("v-select",{staticClass:"mx-3",staticStyle:{"max-width":"80px"},attrs:{items:t.villagesOptions,"item-text":"display_name","item-value":"key","menu-props":"auto","hide-details":"",label:"选择城市","single-line":""},model:{value:t.listQuery.village_id,callback:function(e){t.$set(t.listQuery,"village_id",e)},expression:"listQuery.village_id"}}),i("v-text-field",{staticClass:"mx-3",staticStyle:{"max-width":"120px"},attrs:{label:"公司或单位名称","hide-details":"","single-line":""},model:{value:t.listQuery.keyword,callback:function(e){t.$set(t.listQuery,"keyword",e)},expression:"listQuery.keyword"}})],1)],1),i("div",[i("v-row",{staticClass:"mx-2 mb-3"},[i("v-btn",{staticClass:"mx-1 my-2",attrs:{color:"primary"},on:{click:t.getQuery}},[t._v(" 查询 "),i("v-icon",{attrs:{right:""}},[t._v("mdi-magnify")])],1),i("v-btn",{staticClass:"mx-1 mx-1 my-2",attrs:{color:"primary"},on:{click:t.resetQuery}},[t._v(" 重置 "),i("v-icon",{attrs:{right:""}},[t._v("mdi-lock-reset")])],1),i("export-excel",{attrs:{fields:t.exportFields,worksheet:"客户数据",name:"研一.xls",fetch:t.getListforExport}},[i("v-btn",{staticClass:"mx-1 mx-1 my-2",attrs:{color:"primary"}},[t._v(" 导出 "),i("v-icon",{attrs:{right:""}},[t._v("mdi-arrow-down-bold-circle-outline")])],1)],1),i("div",[i("add-customer-dialog")],1)],1)],1)]),i("v-simple-table",{staticClass:"pa-3",attrs:{"fixed-header":"",height:"735px"},scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",[i("th",[t._v("ID")]),i("th",[t._v("客户名称")]),i("th",[t._v("所在城市")]),i("th",[t._v("公司电话")]),i("th",[t._v("综合描述")]),i("th",[t._v("创建时间")]),i("th",[t._v("最后更新")])])]),i("tbody",t._l(t.items,(function(e){return i("tr",{key:e.id},[i("td",{staticClass:"font-weight-light grey--text text-left",staticStyle:{"font-size":"11px"}},[t._v(" "+t._s(e.id)+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t._f("truncate")(e.name,20))+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(e.city_name)+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(e.phone)+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t._f("truncate")(e.description,40))+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t.$moment(e.create_at).format("YYYY-MM-DD HH:mm:ss"))+" ")]),i("td",{staticClass:"text-left"},[t._v(" "+t._s(t.$moment(e.last_update).format("YYYY-MM-DD HH:mm:ss"))+" "),i("v-btn",{attrs:{color:t.icons.doc.color,icon:"",fab:"","x-small":""},on:{click:function(i){return t.handleToDetails(e)}}},[i("v-icon",{attrs:{right:""},domProps:{textContent:t._s(t.icons.doc.icon)}})],1),t.isAdminRole?i("v-btn",{attrs:{color:t.icons.delete.color,icon:"",fab:"","x-small":""},on:{click:function(i){return t.removeCustomer(e)}}},[i("v-icon",{attrs:{right:""},domProps:{textContent:t._s(t.icons.delete.icon)}})],1):t._e()],1)])})),0)]},proxy:!0}])}),i("v-pagination",{staticClass:"my-3",attrs:{circle:t.circle,disabled:t.disabled,length:t.total_pages,"next-icon":t.nextIcon,"prev-icon":t.prevIcon,"total-visible":t.totalVisible,value:t.listQuery.page},on:{input:t.paginationChangeHandler},model:{value:t.listQuery.page,callback:function(e){t.$set(t.listQuery,"page",e)},expression:"listQuery.page"}}),i("v-snackbar",{attrs:{timeout:t.timeout},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v(" "+t._s(t.text)+" ")])],1)},a=[],n=(i("d3b7"),i("9671")),o=[],r=[],c={name:"Contracts",components:{AddCustomerDialog:function(){return i.e("chunk-2d2091ab").then(i.bind(null,"a842"))}},data:function(){return{snackbar:!1,text:"",timeout:3e3,panel:[0,1],icons:{doc:{color:"blue",icon:"mdi-file-document"},delete:{color:"warning",icon:"mdi-trash-can"}},exportItems:[],items:[],listQuery:{page:1,limit:10,keyword:void 0,activity:void 0,batch_code:void 0,sort:"+id",orderby_id_desc:void 0},search:"",awaitingSearch:!1,circle:!0,disabled:!1,length:10,nextIcon:"mdi-chevron-right",prevIcon:"mdi-chevron-left",totalVisible:10,total_pages:0,exportFields:{},greenColor:"rgb(81, 185, 116)",warningColor:"rgb(241, 211, 171)",batchCodeOptions:o,villagesOptions:r}},computed:{isAdminRole:function(){return"administrator"===this.$store.getters.role.slug}},created:function(){this.getList(),console.log(Date.now())},methods:{handleToDetails:function(t){this.$router.push({name:"CustomerDetails",params:{id:t.id}})},getQuery:function(){this.listQuery.page=1,this.getList()},getList:function(){var t=this;this.listLoading=!0,this.listQuery.limit=10,Object(n["e"])(this.listQuery).then((function(e){t.items=e.data.items,t.total_pages=e.data._meta.total_pages,setTimeout((function(){t.listLoading=!1}),1500)}))},getListforExport:function(){var t=this;return this.listLoading=!0,this.listQuery.limit=1e4,Object(n["e"])(this.listQuery).then((function(e){t.exportItems=e.data.items,setTimeout((function(){t.listLoading=!1}),1500)})),this.exportItems},resetQuery:function(){this.listQuery.keyword=void 0,this.listQuery.batch_code=void 0,this.listQuery.limit=10},removeCustomer:function(t){var e=this;this.$confirm("确认删除客户档案?").then((function(i){i&&Object(n["c"])(t.id).then((function(t){e.getList(),e.text="客户档案删除成功！",e.snackbar=!0}))}))},paginationChangeHandler:function(t){this.listQuery.page=t,this.getList()}}},l=c,d=(i("deb3"),i("2877")),u=i("6544"),m=i.n(u),f=i("8336"),h=i("a523"),v=i("132d"),p=i("891e"),b=i("0fd9"),g=i("b974"),y=i("1f4f"),_=i("2db4"),x=i("b73d"),k=i("8654"),C=Object(d["a"])(l,s,a,!1,null,"1a637fcb",null);e["default"]=C.exports;m()(C,{VBtn:f["a"],VContainer:h["a"],VIcon:v["a"],VPagination:p["a"],VRow:b["a"],VSelect:g["a"],VSimpleTable:y["a"],VSnackbar:_["a"],VSwitch:x["a"],VTextField:k["a"]})},9671:function(t,e,i){"use strict";i.d(e,"e",(function(){return a})),i.d(e,"d",(function(){return n})),i.d(e,"b",(function(){return o})),i.d(e,"f",(function(){return r})),i.d(e,"a",(function(){return c})),i.d(e,"c",(function(){return l}));var s=i("b775");function a(t){return Object(s["a"])({url:"/customers",method:"get",params:t})}function n(t){return Object(s["a"])({url:"/customers/".concat(t),method:"get"})}function o(t){return Object(s["a"])({url:"/customers",method:"post",data:t})}function r(t,e){return Object(s["a"])({url:"/customers/".concat(t),method:"put",data:e})}function c(t,e){return Object(s["a"])({url:"/customers/".concat(t),method:"post",data:e})}function l(t){return Object(s["a"])({url:"/customers/".concat(t),method:"delete"})}},deb3:function(t,e,i){"use strict";var s=i("ed59"),a=i.n(s);a.a},ed59:function(t,e,i){}}]);
//# sourceMappingURL=chunk-5f4abe86.2847707c.js.map