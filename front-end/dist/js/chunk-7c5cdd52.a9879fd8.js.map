{"version":3,"sources":["webpack:///./src/api/visits.js","webpack:///./src/views/dashboard/visits/List.vue?983a","webpack:///src/views/dashboard/visits/List.vue","webpack:///./src/views/dashboard/visits/List.vue?c995","webpack:///./src/views/dashboard/visits/List.vue","webpack:///./src/views/dashboard/visits/List.vue?5171"],"names":["fetchVisits","query","request","url","method","params","fetchVisit","id","createVisit","data","updateVisit","deleteVisit","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","scopedSlots","_u","key","fn","proxy","staticStyle","model","value","listQuery","callback","$$v","$set","expression","customerOptions","on","getQuery","_v","resetQuery","exportFields","getListforExport","_l","row","_s","document_code","_f","title","customer_name","description","author","name","getNamefromOptions","statusCodes","status_code","$moment","create_at","format","last_update","icons","doc","color","$event","handleToDetails","domProps","icon","isAuthor","author_id","delete","removeVisit","_e","circle","disabled","total_pages","nextIcon","prevIcon","totalVisible","page","paginationChangeHandler","timeout","snackbar","text","staticRenderFns","components","AddVisitDialog","computed","isAdminRole","$store","getters","role","slug","created","getList","console","log","Date","now","methods","currentUserId","authorId","listLoading","limit","setTimeout","exportItems","keyword","undefined","batch_code","$confirm","then","res","$router","push","options","forEach","item","showname","display_name","pageNumber","component","VBtn","VContainer","VIcon","VPagination","VRow","VSelect","VSimpleTable","VSnackbar","VSwitch","VTextField"],"mappings":"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","file":"js/chunk-7c5cdd52.a9879fd8.js","sourcesContent":["import request from '@/utils/request'\r\n\r\nexport function fetchVisits(query) {\r\n  return request({\r\n    url: '/visits',\r\n    method: 'get',\r\n    params: query,\r\n  })\r\n}\r\n\r\nexport function fetchVisit(id) {\r\n  return request({\r\n    url: `/visits/${id}`,\r\n    method: 'get',\r\n  })\r\n}\r\n\r\nexport function createVisit(data) {\r\n  return request({\r\n    url: '/visits',\r\n    method: 'post',\r\n    data,\r\n  })\r\n}\r\n\r\nexport function updateVisit(id, data) {\r\n  return request({\r\n    url: `/visits/${id}`,\r\n    method: 'put',\r\n    data,\r\n  })\r\n}\r\n\r\nexport function deleteVisit(id) {\r\n  return request({\r\n    url: `/visits/${id}`,\r\n    method: 'delete',\r\n  })\r\n}\r\n\r\nexport function confirmToAudit(data) {\r\n  return request({\r\n    url: '/visits',\r\n    method: 'post',\r\n    data,\r\n  })\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"px-4 py-0\",attrs:{\"fluid\":\"\"},scopedSlots:_vm._u([{key:\"after-heading\",fn:function(){return undefined},proxy:true}])},[_c('v-row',{staticClass:\"d-flex justify-space-between mx-1 mb-0\"},[_c('div',[_c('v-row',[_c('v-switch',{staticClass:\"mx-3\",staticStyle:{\"max-width\":\"100px\"},attrs:{\"label\":\"倒序\"},model:{value:(_vm.listQuery.orderby_id_desc),callback:function ($$v) {_vm.$set(_vm.listQuery, \"orderby_id_desc\", $$v)},expression:\"listQuery.orderby_id_desc\"}}),_c('v-select',{staticClass:\"mx-3\",staticStyle:{\"max-width\":\"80px\"},attrs:{\"items\":_vm.customerOptions,\"item-text\":\"display_name\",\"item-value\":\"key\",\"menu-props\":\"auto\",\"hide-details\":\"\",\"label\":\"客户名称\",\"single-line\":\"\"},model:{value:(_vm.listQuery.customer_id),callback:function ($$v) {_vm.$set(_vm.listQuery, \"customer_id\", $$v)},expression:\"listQuery.customer_id\"}}),_c('v-text-field',{staticClass:\"mx-3\",staticStyle:{\"max-width\":\"120px\"},attrs:{\"label\":\"姓名\",\"hide-details\":\"\",\"single-line\":\"\"},model:{value:(_vm.listQuery.keyword),callback:function ($$v) {_vm.$set(_vm.listQuery, \"keyword\", $$v)},expression:\"listQuery.keyword\"}})],1)],1),_c('div',[_c('v-row',{staticClass:\"mx-2\"},[_c('v-btn',{staticClass:\"mx-1 my-2\",attrs:{\"color\":\"primary\"},on:{\"click\":_vm.getQuery}},[_vm._v(\" 查询 \"),_c('v-icon',{attrs:{\"right\":\"\"}},[_vm._v(\"mdi-magnify\")])],1),_c('v-btn',{staticClass:\"mx-1 mx-1 my-2\",attrs:{\"color\":\"primary\"},on:{\"click\":_vm.resetQuery}},[_vm._v(\" 重置 \"),_c('v-icon',{attrs:{\"right\":\"\"}},[_vm._v(\"mdi-lock-reset\")])],1),_c('export-excel',{attrs:{\"fields\":_vm.exportFields,\"worksheet\":\"签约数据\",\"name\":\"九色鹿抽签签约数据.xls\",\"fetch\":_vm.getListforExport}},[_c('v-btn',{staticClass:\"mx-1 mx-1 my-2\",attrs:{\"color\":\"primary\"}},[_vm._v(\" 导出 \"),_c('v-icon',{attrs:{\"right\":\"\"}},[_vm._v(\"mdi-arrow-down-bold-circle-outline\")])],1)],1),_c('div',[_c('add-visit-dialog')],1)],1)],1)]),_c('v-simple-table',{staticClass:\"pa-3\",attrs:{\"fixed-header\":\"\",\"height\":\"735px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('thead',[_c('tr',[_c('th',[_vm._v(\"ID\")]),_c('th',[_vm._v(\"档案编号\")]),_c('th',[_vm._v(\"标题\")]),_c('th',[_vm._v(\"公司(单位)名称\")]),_c('th',[_vm._v(\"拜访日志\")]),_c('th',[_vm._v(\"创建者\")]),_c('th',[_vm._v(\"状态\")]),_c('th',[_vm._v(\"创建时间\")]),_c('th',[_vm._v(\"最后编辑\")])])]),_c('tbody',_vm._l((_vm.items),function(row){return _c('tr',{key:row.id},[_c('td',{staticClass:\"font-weight-light grey--text text-left\",staticStyle:{\"font-size\":\"11px\"}},[_vm._v(\" \"+_vm._s(row.id)+\" \")]),_c('td',{staticClass:\"text-left\"},[_vm._v(\" \"+_vm._s(row.document_code)+\" \")]),_c('td',{staticClass:\"text-left\"},[_vm._v(\" \"+_vm._s(_vm._f(\"truncate\")(row.title,15))+\" \")]),_c('td',{staticClass:\"text-left\"},[_vm._v(\" \"+_vm._s(_vm._f(\"truncate\")(row.customer_name,15))+\" \")]),_c('td',{staticClass:\"text-left\"},[_vm._v(\" \"+_vm._s(_vm._f(\"truncate\")(row.description,40))+\" \")]),_c('td',{staticClass:\"text-left\"},[_vm._v(\" \"+_vm._s(row.author.name)+\" \")]),_c('td',{staticClass:\"text-left\"},[_vm._v(\" \"+_vm._s(_vm.getNamefromOptions(_vm.statusCodes, row.status_code))+\" \")]),_c('td',{staticClass:\"text-left\"},[_vm._v(\" \"+_vm._s(_vm.$moment(row.create_at).format('YYYY-MM-DD HH:mm'))+\" \")]),_c('td',{staticClass:\"text-left\"},[_vm._v(\" \"+_vm._s(_vm.$moment(row.last_update).format('YYYY-MM-DD HH:mm'))+\" \"),_c('v-btn',{attrs:{\"color\":_vm.icons.doc.color,\"icon\":\"\",\"fab\":\"\",\"x-small\":\"\"},on:{\"click\":function($event){return _vm.handleToDetails(row)}}},[_c('v-icon',{attrs:{\"right\":\"\"},domProps:{\"textContent\":_vm._s(_vm.icons.doc.icon)}})],1),(_vm.isAuthor(row.author_id) && row.status_code === 0)?_c('v-btn',{attrs:{\"color\":_vm.icons.delete.color,\"icon\":\"\",\"fab\":\"\",\"x-small\":\"\"},on:{\"click\":function($event){return _vm.removeVisit(row)}}},[_c('v-icon',{attrs:{\"right\":\"\"},domProps:{\"textContent\":_vm._s(_vm.icons.delete.icon)}})],1):_vm._e()],1)])}),0)]},proxy:true}])}),_c('v-pagination',{staticClass:\"my-3\",attrs:{\"circle\":_vm.circle,\"disabled\":_vm.disabled,\"length\":_vm.total_pages,\"next-icon\":_vm.nextIcon,\"prev-icon\":_vm.prevIcon,\"total-visible\":_vm.totalVisible,\"value\":_vm.listQuery.page},on:{\"input\":_vm.paginationChangeHandler},model:{value:(_vm.listQuery.page),callback:function ($$v) {_vm.$set(_vm.listQuery, \"page\", $$v)},expression:\"listQuery.page\"}}),_c('v-snackbar',{attrs:{\"timeout\":_vm.timeout},model:{value:(_vm.snackbar),callback:function ($$v) {_vm.snackbar=$$v},expression:\"snackbar\"}},[_vm._v(\" \"+_vm._s(_vm.text)+\" \")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container fluid class=\"px-4 py-0\">\n    <template v-slot:after-heading> </template>\n    <v-row class=\"d-flex justify-space-between mx-1 mb-0\">\n      <div>\n        <v-row>\n          <v-switch\n            v-model=\"listQuery.orderby_id_desc\"\n            label=\"倒序\"\n            style=\"max-width: 100px;\"\n            class=\"mx-3\"\n          ></v-switch>\n\n          <v-select\n            v-model=\"listQuery.customer_id\"\n            :items=\"customerOptions\"\n            item-text=\"display_name\"\n            item-value=\"key\"\n            menu-props=\"auto\"\n            hide-details\n            label=\"客户名称\"\n            single-line\n            class=\"mx-3\"\n            style=\"max-width: 80px;\"\n          ></v-select>\n\n          <v-text-field\n            v-model=\"listQuery.keyword\"\n            label=\"姓名\"\n            hide-details\n            single-line\n            class=\"mx-3\"\n            style=\"max-width: 120px;\"\n          />\n        </v-row>\n      </div>\n      <div>\n        <v-row class=\"mx-2\"\n          ><v-btn color=\"primary\" class=\"mx-1 my-2\" @click=\"getQuery\">\n            查询\n            <v-icon right>mdi-magnify</v-icon>\n          </v-btn>\n\n          <v-btn color=\"primary\" class=\"mx-1 mx-1 my-2\" @click=\"resetQuery\">\n            重置\n            <v-icon right>mdi-lock-reset</v-icon>\n          </v-btn>\n\n          <export-excel\n            :fields=\"exportFields\"\n            worksheet=\"签约数据\"\n            name=\"九色鹿抽签签约数据.xls\"\n            :fetch=\"getListforExport\"\n          >\n            <v-btn color=\"primary\" class=\"mx-1 mx-1 my-2\">\n              导出\n              <v-icon right>mdi-arrow-down-bold-circle-outline</v-icon>\n            </v-btn>\n          </export-excel>\n\n          <div>\n            <add-visit-dialog />\n          </div>\n        </v-row>\n      </div>\n    </v-row>\n\n    <!-- <v-divider class=\"mt-3\" /> -->\n\n    <v-simple-table fixed-header class=\"pa-3\" height=\"735px\">\n      <template v-slot:default>\n        <thead>\n          <tr>\n            <th>ID</th>\n            <th>档案编号</th>\n            <th>标题</th>\n            <th>公司(单位)名称</th>\n            <th>拜访日志</th>\n            <th>创建者</th>\n            <th>状态</th>\n            <th>创建时间</th>\n            <th>最后编辑</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"row in items\" :key=\"row.id\">\n            <td\n              class=\"font-weight-light grey--text text-left\"\n              style=\"font-size:11px\"\n            >\n              {{ row.id }}\n            </td>\n            <td class=\"text-left\">\n              {{ row.document_code }}\n            </td>\n            <td class=\"text-left\">\n              {{ row.title | truncate(15) }}\n            </td>\n            <td class=\"text-left\">\n              {{ row.customer_name | truncate(15) }}\n            </td>\n            <!-- <td class=\"text-left\">\n              {{ row.contactor_name | truncate(15) }}\n            </td> -->\n            <td class=\"text-left\">\n              {{ row.description | truncate(40) }}\n            </td>\n            <td class=\"text-left\">\n              {{ row.author.name }}\n            </td>\n            <td class=\"text-left\">\n              <!-- {{ row.status_code }} -->\n              {{ getNamefromOptions(statusCodes, row.status_code) }}\n            </td>\n            <td class=\"text-left\">\n              {{ $moment(row.create_at).format('YYYY-MM-DD HH:mm') }}\n            </td>\n\n            <td class=\"text-left\">\n              {{ $moment(row.last_update).format('YYYY-MM-DD HH:mm') }}\n              <v-btn\n                :color=\"icons.doc.color\"\n                icon\n                fab\n                x-small\n                @click=\"handleToDetails(row)\"\n              >\n                <v-icon right v-text=\"icons.doc.icon\" />\n              </v-btn>\n\n              <v-btn\n                v-if=\"isAuthor(row.author_id) && row.status_code === 0\"\n                :color=\"icons.delete.color\"\n                icon\n                fab\n                x-small\n                @click=\"removeVisit(row)\"\n              >\n                <v-icon right v-text=\"icons.delete.icon\" />\n              </v-btn>\n            </td>\n          </tr>\n        </tbody>\n      </template>\n    </v-simple-table>\n    <v-pagination\n      v-model=\"listQuery.page\"\n      :circle=\"circle\"\n      :disabled=\"disabled\"\n      :length=\"total_pages\"\n      :next-icon=\"nextIcon\"\n      :prev-icon=\"prevIcon\"\n      :total-visible=\"totalVisible\"\n      :value=\"listQuery.page\"\n      class=\"my-3\"\n      @input=\"paginationChangeHandler\"\n    ></v-pagination>\n    <v-snackbar v-model=\"snackbar\" :timeout=\"timeout\">\n      {{ text }}\n    </v-snackbar>\n  </v-container>\n</template>\n\n<script>\nimport {\n  fetchVisits,\n  // updateCustomer,\n  deleteVisit,\n} from '@/api/visits'\n\nconst statusCodes = [\n  { key: 0, display_name: '新建' },\n  { key: 1, display_name: '提审' },\n  // { key: 2, display_name: '完成' },\n  { key: 3, display_name: '完成' },\n  { key: 9, display_name: '驳回' },\n]\n\nexport default {\n  name: 'Visits',\n\n  components: {\n    AddVisitDialog: () => import('./addVisitDialog'),\n  },\n\n  data: () => ({\n    statusCodes,\n    snackbar: false,\n    text: '',\n    timeout: 3000,\n    panel: [0, 1],\n    icons: {\n      doc: {\n        color: 'blue',\n        icon: 'mdi-file-document',\n      },\n      delete: {\n        color: 'warning',\n        icon: 'mdi-trash-can',\n      },\n    },\n    exportFields: {},\n    items: [],\n    listQuery: {\n      page: 1,\n      limit: 10,\n      keyword: undefined,\n      activity: undefined,\n      batch_code: undefined,\n      sort: '+id',\n      orderby_id_desc: undefined,\n    },\n    search: '',\n    awaitingSearch: false,\n    circle: true,\n    disabled: false,\n    length: 10,\n    nextIcon: 'mdi-chevron-right',\n    prevIcon: 'mdi-chevron-left',\n    totalVisible: 10,\n    total_pages: 0,\n    customerOptions: [],\n  }),\n\n  computed: {\n    isAdminRole() {\n      if (this.$store.getters.role.slug === 'administrator') {\n        return true\n      } else {\n        return false\n      }\n    },\n  },\n\n  created() {\n    this.getList()\n    console.log(Date.now())\n  },\n\n  methods: {\n    getQuery() {\n      this.listQuery.page = 1\n      this.getList()\n    },\n\n    isAuthor(authorId) {\n      const currentUserId = this.$store.getters.userId\n      return currentUserId === authorId\n    },\n    getList() {\n      this.listLoading = true\n      this.listQuery.limit = 10\n      // this.listQuery.keyword = this.search\n\n      fetchVisits(this.listQuery).then(response => {\n        this.items = response.data.items\n        this.total_pages = response.data._meta.total_pages\n\n        // Just to simulate the time of the request\n        setTimeout(() => {\n          this.listLoading = false\n        }, 1.5 * 1000)\n      })\n    },\n\n    getListforExport() {\n      this.listLoading = true\n      this.listQuery.limit = 10000\n      fetchVisits(this.listQuery).then(response => {\n        this.exportItems = response.data.items\n        // Just to simulate the time of the request\n        setTimeout(() => {\n          this.listLoading = false\n        }, 1.5 * 1000)\n      })\n      return this.exportItems\n    },\n\n    resetQuery() {\n      this.listQuery.keyword = undefined\n      this.listQuery.batch_code = undefined\n      this.listQuery.limit = 10\n    },\n\n    removeVisit(row) {\n      this.$confirm('确认删除拜访日志?').then(res => {\n        if (res) {\n          deleteVisit(row.id).then(response => {\n            this.getList()\n            // Just to simulate the time of the request\n            this.text = '拜访日志删除成功！'\n            this.snackbar = true\n          })\n        }\n      })\n    },\n\n    handleToDetails(row) {\n      this.$router.push({\n        name: 'VisitDetails',\n        params: { id: row.id },\n      })\n    },\n\n    getNamefromOptions(options, key) {\n      let showname = ''\n      options.forEach(item => {\n        if (item.key === key) {\n          showname = item.display_name\n        }\n      })\n      return showname\n    },\n\n    paginationChangeHandler(pageNumber) {\n      this.listQuery.page = pageNumber\n      this.getList()\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\nth {\n  font-size: 12px !important;\n  font-weight: 800 !important;\n}\n\ntr:hover {\n  background-color: #43b4dd !important;\n  color: rgb(255, 255, 255);\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./List.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./List.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./List.vue?vue&type=template&id=470b693b&scoped=true&\"\nimport script from \"./List.vue?vue&type=script&lang=js&\"\nexport * from \"./List.vue?vue&type=script&lang=js&\"\nimport style0 from \"./List.vue?vue&type=style&index=0&id=470b693b&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"470b693b\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VPagination } from 'vuetify/lib/components/VPagination';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VSelect } from 'vuetify/lib/components/VSelect';\nimport { VSimpleTable } from 'vuetify/lib/components/VDataTable';\nimport { VSnackbar } from 'vuetify/lib/components/VSnackbar';\nimport { VSwitch } from 'vuetify/lib/components/VSwitch';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VContainer,VIcon,VPagination,VRow,VSelect,VSimpleTable,VSnackbar,VSwitch,VTextField})\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./List.vue?vue&type=style&index=0&id=470b693b&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/vuetify-loader/lib/loader.js??ref--18-0!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./List.vue?vue&type=style&index=0&id=470b693b&lang=scss&scoped=true&\""],"sourceRoot":""}