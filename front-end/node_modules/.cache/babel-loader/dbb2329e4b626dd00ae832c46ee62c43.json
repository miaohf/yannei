{"remainingRequest":"D:\\mycode\\Yanei\\front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\visits\\Details.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\visits\\Details.vue","mtime":1655776694674},{"path":"D:\\mycode\\Yanei\\front-end\\babel.config.js","mtime":1580387978000},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1668956708481},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1668956821544}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIjsKaW1wb3J0IHsgZmV0Y2hWaXNpdCwgdXBkYXRlVmlzaXQgfSBmcm9tICdAL2FwaS92aXNpdHMnOwppbXBvcnQgeyBmZXRjaENvbnRhY3RvcnNMaXN0YnlDdXN0b21lcklkLCBmZXRjaEFkZHJlc3Nlc0xpc3RieUN1c3RvbWVySWQsIGZldGNoVmlzaXR0eXBlc0xpc3QgfSBmcm9tICdAL2FwaS9zZWxlY3Rpb25zJzsKdmFyIHN0YXR1c0NvZGVzID0gW3sKICBrZXk6IDAsCiAgZGlzcGxheV9uYW1lOiAn5paw5bu6Jwp9LCB7CiAga2V5OiAxLAogIGRpc3BsYXlfbmFtZTogJ+aPkOWuoScKfSwKLy8geyBrZXk6IDIsIGRpc3BsYXlfbmFtZTogJ+WujOaIkCcgfSwKewogIGtleTogMywKICBkaXNwbGF5X25hbWU6ICflrozmiJAnCn0sIHsKICBrZXk6IDksCiAgZGlzcGxheV9uYW1lOiAn6amz5ZueJwp9XTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdWaXNpdERldGFpbHMnLAogIGNvbXBvbmVudHM6IHsKICAgIFVwbG9hZFBpY3R1cmVEaWFsb2c6IGZ1bmN0aW9uIFVwbG9hZFBpY3R1cmVEaWFsb2coKSB7CiAgICAgIHJldHVybiBpbXBvcnQoJy4vdXBsb2FkUGljdHVyZURpYWxvZycpOwogICAgfQogIH0sCiAgZmlsdGVyczogewogICAgc3RhdHVzRmlsdGVyOiBmdW5jdGlvbiBzdGF0dXNGaWx0ZXIoc3RhdHVzKSB7CiAgICAgIHZhciBzdGF0dXNNYXAgPSB7CiAgICAgICAgcHVibGlzaGVkOiAnc3VjY2VzcycsCiAgICAgICAgZHJhZnQ6ICdpbmZvJywKICAgICAgICBkZWxldGVkOiAnZGFuZ2VyJwogICAgICB9OwogICAgICByZXR1cm4gc3RhdHVzTWFwW3N0YXR1c107CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbGlzdExvYWRpbmc6IGZhbHNlLAogICAgICBjb250YWN0b3JzOiBbXSwKICAgICAgYWRkcmVzc2VzOiBbXSwKICAgICAgdmlzaXR0eXBlczogW10sCiAgICAgIHN0YXR1c0NvZGVzOiBzdGF0dXNDb2RlcywKICAgICAgZGV0YWlsczogbnVsbCwKICAgICAgdGVtcDogewogICAgICAgIGF1dGhvcjogJycsCiAgICAgICAgYXR0YWNobWVudHM6IFtdLAogICAgICAgIG9yZGVyOiB7CiAgICAgICAgICBvcmRlcnJlY3M6IFtdCiAgICAgICAgfQogICAgICB9LAogICAgICBydWxlczoge30sCiAgICAgIHVzZXJzOiBbXSwKICAgICAgaXNFZGl0OiBmYWxzZQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBpc0FkbWluUm9sZTogZnVuY3Rpb24gaXNBZG1pblJvbGUoKSB7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLnJvbGVzLmluY2x1ZGVzKCdhZG1pbicpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5mZXRjaERhdGEoKTsKICAgIHRoaXMuZ2V0VmlzaXR0eXBlc0xpc3QoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdvQmFjazogZnVuY3Rpb24gZ29CYWNrKCkgewogICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpOwogICAgfSwKICAgIGlzQXV0aG9yOiBmdW5jdGlvbiBpc0F1dGhvcihhdXRob3JJZCkgewogICAgICB2YXIgY3VycmVudFVzZXJJZCA9IHRoaXMuJHN0b3JlLmdldHRlcnMudXNlcklkOwogICAgICByZXR1cm4gY3VycmVudFVzZXJJZCA9PT0gYXV0aG9ySWQ7CiAgICB9LAogICAgZmV0Y2hEYXRhOiBmdW5jdGlvbiBmZXRjaERhdGEoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHRoaXMubGlzdExvYWRpbmcgPSB0cnVlOwogICAgICB2YXIgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMgJiYgdGhpcy4kcm91dGUucGFyYW1zLmlkOwogICAgICBmZXRjaFZpc2l0KGlkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzLnRlbXAgPSByZXNwb25zZS5kYXRhOwogICAgICAgIF90aGlzLmdldENvbnRhY3RvcnNMaXN0YnlDdXN0b21lcklkKF90aGlzLnRlbXAuY3VzdG9tZXJfaWQpOwogICAgICAgIF90aGlzLmdldEFkZHJlc3Nlc0xpc3RieUN1c3RvbWVySWQoX3RoaXMudGVtcC5jdXN0b21lcl9pZCk7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sIDUgKiAxMDAwKTsKICAgICAgfSk7CiAgICB9LAogICAgc3VibWl0QXVkaXQ6IGZ1bmN0aW9uIHN1Ym1pdEF1ZGl0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgdGhpcy5saXN0TG9hZGluZyA9IHRydWU7CiAgICAgIHZhciBpZCA9IHRoaXMuJHJvdXRlLnBhcmFtcyAmJiB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgIHZhciB0ZW1wRGF0YSA9IHsKICAgICAgICBzdGF0dXNfY29kZTogMQogICAgICB9OwogICAgICB0aGlzLiRjb25maXJtKCfnoa7orqTml6Xlv5floavlhpnlt7LlrozmlbTlubbopoHmj5DkuqTlrqHmoLg/JykudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgdXBkYXRlVmlzaXQoaWQsIHRlbXBEYXRhKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczIudGVtcCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIF90aGlzMi5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICB9LCA1ICogMTAwMCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNhbmNlbEF1ZGl0OiBmdW5jdGlvbiBjYW5jZWxBdWRpdCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHRoaXMubGlzdExvYWRpbmcgPSB0cnVlOwogICAgICB2YXIgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMgJiYgdGhpcy4kcm91dGUucGFyYW1zLmlkOwogICAgICB2YXIgdGVtcERhdGEgPSB7CiAgICAgICAgc3RhdHVzX2NvZGU6IDAKICAgICAgfTsKICAgICAgdGhpcy4kY29uZmlybSgn56Gu6K6k5pKk6ZSA5pel5b+X5a6h5qC4PycpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGlmIChyZXMpIHsKICAgICAgICAgIHVwZGF0ZVZpc2l0KGlkLCB0ZW1wRGF0YSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXMzLnRlbXAgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBfdGhpczMubGlzdExvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfSwgNSAqIDEwMDApOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBnZXRDb250YWN0b3JzTGlzdGJ5Q3VzdG9tZXJJZDogZnVuY3Rpb24gZ2V0Q29udGFjdG9yc0xpc3RieUN1c3RvbWVySWQoaWQpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIGZldGNoQ29udGFjdG9yc0xpc3RieUN1c3RvbWVySWQoaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXM0LmNvbnRhY3RvcnMgPSByZXNwb25zZS5kYXRhLml0ZW1zOwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXM0Lmxpc3RMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfSwgMS41ICogMTAwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldEFkZHJlc3Nlc0xpc3RieUN1c3RvbWVySWQ6IGZ1bmN0aW9uIGdldEFkZHJlc3Nlc0xpc3RieUN1c3RvbWVySWQoaWQpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CiAgICAgIGZldGNoQWRkcmVzc2VzTGlzdGJ5Q3VzdG9tZXJJZChpZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczUuYWRkcmVzc2VzID0gcmVzcG9uc2UuZGF0YS5pdGVtczsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzNS5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sIDEuNSAqIDEwMDApOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRWaXNpdHR5cGVzTGlzdDogZnVuY3Rpb24gZ2V0VmlzaXR0eXBlc0xpc3QoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwogICAgICBmZXRjaFZpc2l0dHlwZXNMaXN0KCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczYudmlzaXR0eXBlcyA9IHJlc3BvbnNlLmRhdGEuaXRlbXM7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczYubGlzdExvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9LCAxLjUgKiAxMDAwKTsKICAgICAgfSk7CiAgICB9LAogICAgY29uZmlybUVkaXQ6IGZ1bmN0aW9uIGNvbmZpcm1FZGl0KCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKICAgICAgdGhpcy5saXN0TG9hZGluZyA9IHRydWU7CiAgICAgIHZhciBpZCA9IHRoaXMuJHJvdXRlLnBhcmFtcyAmJiB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgIHVwZGF0ZVZpc2l0KGlkLCB0aGlzLnRlbXApLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXM3LnRlbXAgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXM3Lmxpc3RMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfSwgNSAqIDEwMDApOwogICAgICB9KTsKICAgICAgdGhpcy5pc0VkaXQgPSAhdGhpcy5pc0VkaXQ7CiAgICB9LAogICAgZ2V0TmFtZWZyb21PcHRpb25zOiBmdW5jdGlvbiBnZXROYW1lZnJvbU9wdGlvbnMob3B0aW9ucywga2V5KSB7CiAgICAgIC8vIHJldHVybiBvcHRpb25zW2tleV0KICAgICAgdmFyIHNob3duYW1lID0gJyc7CiAgICAgIG9wdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGlmIChpdGVtLmtleSA9PT0ga2V5KSB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhrZXksIGl0ZW0ua2V5LCBpdGVtLmRpc3BsYXlfbmFtZSkKICAgICAgICAgIHNob3duYW1lID0gaXRlbS5kaXNwbGF5X25hbWU7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIHNob3duYW1lOwogICAgfSwKICAgIGNhbmNlbEVkaXQ6IGZ1bmN0aW9uIGNhbmNlbEVkaXQoKSB7CiAgICAgIHRoaXMuaXNFZGl0ID0gIXRoaXMuaXNFZGl0OwogICAgICB0aGlzLmZldGNoRGF0YSgpOwogICAgfSwKICAgIGdldFNvcnRDbGFzczogZnVuY3Rpb24gZ2V0U29ydENsYXNzKGtleSkgewogICAgICB2YXIgc29ydCA9IHRoaXMubGlzdFF1ZXJ5LnNvcnQ7CiAgICAgIHJldHVybiBzb3J0ID09PSAiKyIuY29uY2F0KGtleSkgPyAnYXNjZW5kaW5nJyA6ICdkZXNjZW5kaW5nJzsKICAgIH0KICB9Cn07"},{"version":3,"mappings":";;;;;;;AA+OA;AACA,SACAA,iCACAC,gCACAC,2BACA;AACA,mBACA;EAAAC;EAAAC;AAAA,GACA;EAAAD;EAAAC;AAAA;AACA;AACA;EAAAD;EAAAC;AAAA,GACA;EAAAD;EAAAC;AAAA,EACA;AAEA;EACAC;EACAC;IACAC;MAAA;IAAA;EACA;EACAC;IACAC;MACA;QACAC;QACAC;QACAC;MACA;MACA;IACA;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QAAAC;QAAAC;QAAAC;UAAAC;QAAA;MAAA;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACAC;MACA;QACA;MACA;QACA;MACA;IACA;EACA;EAEAC;IACA;IACA;EACA;EAEAC;IACAC;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MAAA;MACA;MACA;MACAC;QACA;QACA;QACA;QACAC;UACA;QACA;MACA;IACA;IAEAC;MAAA;MACA;MACA;MACA;QAAAC;MAAA;MACA;QACA;UACAC;YACA;YACAH;cACA;YACA;UACA;QACA;MACA;IACA;IAEAI;MAAA;MACA;MACA;MACA;QAAAF;MAAA;MACA;QACA;UACAC;YACA;YACAH;cACA;YACA;UACA;QACA;MACA;IACA;IAEAK;MAAA;MACAzC;QACA;QACAoC;UACA;QACA;MACA;IACA;IAEAM;MAAA;MACAzC;QACA;QACAmC;UACA;QACA;MACA;IACA;IAEAO;MAAA;MACAzC;QACA;QACAkC;UACA;QACA;MACA;IACA;IAEAQ;MAAA;MACA;MACA;MACAL;QACA;QACAH;UACA;QACA;MACA;MACA;IACA;IAEAS;MACA;MACA;MACAC;QACA;UACA;UACAC;QACA;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;EACA;AACA","names":["fetchContactorsListbyCustomerId","fetchAddressesListbyCustomerId","fetchVisittypesList","key","display_name","name","components","UploadPictureDialog","filters","statusFilter","published","draft","deleted","data","listLoading","contactors","addresses","visittypes","statusCodes","details","temp","author","attachments","order","orderrecs","rules","users","isEdit","computed","isAdminRole","created","methods","goBack","isAuthor","fetchData","fetchVisit","setTimeout","submitAudit","status_code","updateVisit","cancelAudit","getContactorsListbyCustomerId","getAddressesListbyCustomerId","getVisittypesList","confirmEdit","getNamefromOptions","options","showname","cancelEdit","getSortClass"],"sourceRoot":"src/views/dashboard/visits","sources":["Details.vue"],"sourcesContent":["<template>\r\n  <v-container fluid class=\"px-4 py-0\">\r\n    <template v-slot:after-heading> </template>\r\n    <v-card class=\"pt-6\" min-height=\"760px\">\r\n      <v-card-actions>\r\n        <v-spacer></v-spacer>\r\n        <div\r\n          v-if=\"isEdit && temp.status_code === 0 && isAuthor(temp.author_id)\"\r\n          align=\"center\"\r\n          justify=\"center\"\r\n        >\r\n          <upload-picture-dialog></upload-picture-dialog>\r\n        </div>\r\n        <v-btn\r\n          v-show=\"!isEdit && temp.status_code === 0 && isAuthor(temp.author_id)\"\r\n          color=\"warning\"\r\n          @click=\"isEdit = !isEdit\"\r\n          >修改<v-icon right>mdi-text-box-edit</v-icon>\r\n        </v-btn>\r\n        <v-btn\r\n          v-show=\"!isEdit && temp.status_code === 0 && isAuthor(temp.author_id)\"\r\n          color=\"primary\"\r\n          @click=\"submitAudit\"\r\n          >提交<v-icon right>mdi-check-bold</v-icon>\r\n        </v-btn>\r\n        <v-btn\r\n          v-show=\"!isEdit && temp.status_code === 1 && isAuthor(temp.author_id)\"\r\n          color=\"warning\"\r\n          @click=\"cancelAudit\"\r\n          >撤回<v-icon right>mdi-check-bold</v-icon>\r\n        </v-btn>\r\n        <v-btn v-show=\"isEdit\" color=\"info\" @click=\"cancelEdit\"\r\n          ><v-icon>mdi-close-outline </v-icon></v-btn\r\n        >\r\n        <v-btn v-show=\"isEdit\" color=\"green\" @click=\"confirmEdit\"\r\n          ><v-icon text>mdi-check-outline</v-icon>\r\n        </v-btn>\r\n      </v-card-actions>\r\n      <div class=\"px-10 pb-5\">\r\n        <v-row>\r\n          <v-col cols=\"12\" md=\"7\">\r\n            <v-row>\r\n              <v-col cols=\"12\" md=\"10\">\r\n                <v-text-field\r\n                  v-model=\"temp.customer_name\"\r\n                  color=\"yellow darken-3\"\r\n                  label=\"客户名称\"\r\n                  hint=\"\"\r\n                  required\r\n                  disabled\r\n                  prepend-icon=\"mdi-account-group\"\r\n                ></v-text-field\r\n              ></v-col>\r\n            </v-row>\r\n            <v-row>\r\n              <v-col cols=\"12\" md=\"6\">\r\n                <v-text-field\r\n                  v-model=\"temp.title\"\r\n                  color=\"yellow darken-3\"\r\n                  label=\"标题\"\r\n                  hint=\"简述此次拜访目的\"\r\n                  required\r\n                  :disabled=\"!isEdit\"\r\n                  prepend-icon=\"mdi-subtitles\"\r\n                ></v-text-field>\r\n              </v-col>\r\n              <v-col cols=\"12\" md=\"2\">\r\n                <v-text-field\r\n                  v-model=\"temp.author.name\"\r\n                  color=\"yellow darken-3\"\r\n                  label=\"创建者\"\r\n                  required\r\n                  disabled\r\n                  prepend-icon=\"mdi-account\"\r\n                ></v-text-field>\r\n              </v-col>\r\n              <v-col cols=\"12\" md=\"2\">\r\n                <v-autocomplete\r\n                  v-model=\"temp.status_code\"\r\n                  :items=\"statusCodes\"\r\n                  item-text=\"display_name\"\r\n                  item-value=\"key\"\r\n                  label=\"当前状态\"\r\n                  placeholder=\"\"\r\n                  prepend-icon=\"mdi-alpha-s-box\"\r\n                  disabled\r\n                ></v-autocomplete>\r\n              </v-col>\r\n            </v-row>\r\n            <!-- <v-row>\r\n              <v-col cols=\"12\" md=\"2\">\r\n                <v-autocomplete\r\n                  v-model=\"temp.status_code\"\r\n                  :items=\"statusCodes\"\r\n                  item-text=\"display_name\"\r\n                  item-value=\"key\"\r\n                  label=\"当前状态\"\r\n                  placeholder=\"\"\r\n                  prepend-icon=\"mdi-alpha-s-box\"\r\n                  disabled\r\n                ></v-autocomplete>\r\n              </v-col>\r\n            </v-row> -->\r\n            <v-row>\r\n              <v-col>\r\n                <v-textarea\r\n                  v-model=\"temp.description\"\r\n                  color=\"yellow darken-3\"\r\n                  label=\"描述拜访经过和成果\"\r\n                  hint=\"\"\r\n                  required\r\n                  :disabled=\"!isEdit\"\r\n                  prepend-icon=\"mdi-content-copy\"\r\n                  auto-grow\r\n                ></v-textarea>\r\n              </v-col>\r\n            </v-row>\r\n\r\n            <v-row>\r\n              <!-- <v-col>\r\n                <v-autocomplete\r\n                  v-model=\"temp.visittype_id\"\r\n                  :items=\"visittypes\"\r\n                  item-text=\"name\"\r\n                  item-value=\"id\"\r\n                  label=\"拜访类型\"\r\n                  placeholder=\"\"\r\n                  prepend-icon=\"mdi-alpha-t-circle\"\r\n                  :disabled=\"!isEdit\"\r\n                ></v-autocomplete>\r\n              </v-col> -->\r\n              <!-- <v-col cols=\"12\" md=\"4\">\r\n                <span v-for=\"(c, i) in temp.contactors\" :key=\"i\">\r\n                  {{ c.name }}\r\n                </span>\r\n              </v-col>\r\n              <v-col cols=\"12\" md=\"4\">\r\n                <span>{{ temp.address.address_info }}</span>\r\n              </v-col> -->\r\n              <v-col>\r\n                <v-autocomplete\r\n                  v-model=\"temp.contactorids\"\r\n                  :items=\"contactors\"\r\n                  item-text=\"name\"\r\n                  item-value=\"id\"\r\n                  label=\"联系人\"\r\n                  placeholder=\"本次拜访接待人员\"\r\n                  prepend-icon=\"mdi-account-search-outline\"\r\n                  multiple\r\n                  chips\r\n                  :disabled=\"!isEdit\"\r\n                ></v-autocomplete>\r\n              </v-col>\r\n\r\n              <!-- <v-col>\r\n                <v-autocomplete\r\n                  v-model=\"temp.status_code\"\r\n                  :items=\"statusCodes\"\r\n                  item-text=\"display_name\"\r\n                  item-value=\"key\"\r\n                  label=\"审核节点\"\r\n                  placeholder=\"\"\r\n                  prepend-icon=\"mdi-alpha-p-circle\"\r\n                  disabled\r\n                ></v-autocomplete>\r\n              </v-col> -->\r\n            </v-row>\r\n            <v-row>\r\n              <!-- <v-col>\r\n                <v-autocomplete\r\n                  v-model=\"temp.visittype_id\"\r\n                  :items=\"visittypes\"\r\n                  item-text=\"name\"\r\n                  item-value=\"id\"\r\n                  label=\"拜访类型\"\r\n                  placeholder=\"\"\r\n                  prepend-icon=\"mdi-alpha-t-circle\"\r\n                  :disabled=\"!isEdit\"\r\n                ></v-autocomplete>\r\n              </v-col> -->\r\n              <v-col>\r\n                <v-autocomplete\r\n                  v-model=\"temp.address_id\"\r\n                  :items=\"addresses\"\r\n                  item-text=\"name\"\r\n                  item-value=\"id\"\r\n                  label=\"拜访地址\"\r\n                  placeholder=\"本次拜访会面地址\"\r\n                  prepend-icon=\"mdi-account-search\"\r\n                  :disabled=\"!isEdit\"\r\n                ></v-autocomplete>\r\n              </v-col>\r\n            </v-row>\r\n            <v-row v-if=\"temp.order\">\r\n              <v-col v-for=\"(orderrec, i) in temp.order.orderrecs\" :key=\"i\">\r\n                <v-row>\r\n                  <v-text-field\r\n                    v-if=\"orderrec.auditor\"\r\n                    v-model=\"orderrec.auditor.name\"\r\n                    color=\"yellow darken-3\"\r\n                    label=\"审批人\"\r\n                    required\r\n                    disabled\r\n                    prepend-icon=\"mdi-subtitles\"\r\n                  ></v-text-field>\r\n                  <v-text-field\r\n                    v-model=\"orderrec.opinion_text\"\r\n                    color=\"yellow darken-3\"\r\n                    label=\"意见\"\r\n                    required\r\n                    disabled\r\n                    prepend-icon=\"mdi-subtitles\"\r\n                  ></v-text-field>\r\n                </v-row>\r\n              </v-col>\r\n            </v-row>\r\n          </v-col>\r\n\r\n          <v-col cols=\"12\" md=\"5\">\r\n            <v-carousel\r\n              cycle\r\n              height=\"600\"\r\n              show-arrows-on-hover\r\n              delimiter-icon=\"mdi-minus\"\r\n            >\r\n              <v-carousel-item v-for=\"(attach, i) in temp.attachments\" :key=\"i\">\r\n                <v-row class=\"fill-height\" align=\"center\" justify=\"center\">\r\n                  <v-img max-height=\"600\" :src=\"attach.uri\"></v-img>\r\n                </v-row>\r\n              </v-carousel-item>\r\n            </v-carousel>\r\n          </v-col>\r\n        </v-row>\r\n      </div>\r\n    </v-card>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nimport { fetchVisit, updateVisit } from '@/api/visits'\r\nimport {\r\n  fetchContactorsListbyCustomerId,\r\n  fetchAddressesListbyCustomerId,\r\n  fetchVisittypesList,\r\n} from '@/api/selections'\r\nconst statusCodes = [\r\n  { key: 0, display_name: '新建' },\r\n  { key: 1, display_name: '提审' },\r\n  // { key: 2, display_name: '完成' },\r\n  { key: 3, display_name: '完成' },\r\n  { key: 9, display_name: '驳回' },\r\n]\r\n\r\nexport default {\r\n  name: 'VisitDetails',\r\n  components: {\r\n    UploadPictureDialog: () => import('./uploadPictureDialog'),\r\n  },\r\n  filters: {\r\n    statusFilter(status) {\r\n      const statusMap = {\r\n        published: 'success',\r\n        draft: 'info',\r\n        deleted: 'danger',\r\n      }\r\n      return statusMap[status]\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      listLoading: false,\r\n      contactors: [],\r\n      addresses: [],\r\n      visittypes: [],\r\n      statusCodes,\r\n      details: null,\r\n      temp: { author: '', attachments: [], order: { orderrecs: [] } },\r\n      rules: {},\r\n      users: [],\r\n      isEdit: false,\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    isAdminRole() {\r\n      if (this.$store.getters.roles.includes('admin')) {\r\n        return true\r\n      } else {\r\n        return false\r\n      }\r\n    },\r\n  },\r\n\r\n  created() {\r\n    this.fetchData()\r\n    this.getVisittypesList()\r\n  },\r\n\r\n  methods: {\r\n    goBack() {\r\n      this.$router.go(-1)\r\n    },\r\n\r\n    isAuthor(authorId) {\r\n      const currentUserId = this.$store.getters.userId\r\n      return currentUserId === authorId\r\n    },\r\n\r\n    fetchData() {\r\n      this.listLoading = true\r\n      const id = this.$route.params && this.$route.params.id\r\n      fetchVisit(id).then(response => {\r\n        this.temp = response.data\r\n        this.getContactorsListbyCustomerId(this.temp.customer_id)\r\n        this.getAddressesListbyCustomerId(this.temp.customer_id)\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 5 * 1000)\r\n      })\r\n    },\r\n\r\n    submitAudit() {\r\n      this.listLoading = true\r\n      const id = this.$route.params && this.$route.params.id\r\n      const tempData = { status_code: 1 }\r\n      this.$confirm('确认日志填写已完整并要提交审核?').then(res => {\r\n        if (res) {\r\n          updateVisit(id, tempData).then(response => {\r\n            this.temp = response.data\r\n            setTimeout(() => {\r\n              this.listLoading = false\r\n            }, 5 * 1000)\r\n          })\r\n        }\r\n      })\r\n    },\r\n\r\n    cancelAudit() {\r\n      this.listLoading = true\r\n      const id = this.$route.params && this.$route.params.id\r\n      const tempData = { status_code: 0 }\r\n      this.$confirm('确认撤销日志审核?').then(res => {\r\n        if (res) {\r\n          updateVisit(id, tempData).then(response => {\r\n            this.temp = response.data\r\n            setTimeout(() => {\r\n              this.listLoading = false\r\n            }, 5 * 1000)\r\n          })\r\n        }\r\n      })\r\n    },\r\n\r\n    getContactorsListbyCustomerId(id) {\r\n      fetchContactorsListbyCustomerId(id).then(response => {\r\n        this.contactors = response.data.items\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 1.5 * 1000)\r\n      })\r\n    },\r\n\r\n    getAddressesListbyCustomerId(id) {\r\n      fetchAddressesListbyCustomerId(id).then(response => {\r\n        this.addresses = response.data.items\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 1.5 * 1000)\r\n      })\r\n    },\r\n\r\n    getVisittypesList() {\r\n      fetchVisittypesList().then(response => {\r\n        this.visittypes = response.data.items\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 1.5 * 1000)\r\n      })\r\n    },\r\n\r\n    confirmEdit() {\r\n      this.listLoading = true\r\n      const id = this.$route.params && this.$route.params.id\r\n      updateVisit(id, this.temp).then(response => {\r\n        this.temp = response.data\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 5 * 1000)\r\n      })\r\n      this.isEdit = !this.isEdit\r\n    },\r\n\r\n    getNamefromOptions(options, key) {\r\n      // return options[key]\r\n      let showname = ''\r\n      options.forEach(item => {\r\n        if (item.key === key) {\r\n          // console.log(key, item.key, item.display_name)\r\n          showname = item.display_name\r\n        }\r\n      })\r\n      return showname\r\n    },\r\n\r\n    cancelEdit() {\r\n      this.isEdit = !this.isEdit\r\n      this.fetchData()\r\n    },\r\n\r\n    getSortClass: function(key) {\r\n      const sort = this.listQuery.sort\r\n      return sort === `+${key}` ? 'ascending' : 'descending'\r\n    },\r\n  },\r\n}\r\n</script>\r\n<style scoped>\r\n/* .v-overflow-btn .v-input__slot::before {\r\n  border-color: grey !important;\r\n} */\r\n</style>\r\n"]}]}