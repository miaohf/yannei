{"remainingRequest":"D:\\mycode\\Yanei\\front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\customers\\Details.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\customers\\Details.vue","mtime":1655714819544},{"path":"D:\\mycode\\Yanei\\front-end\\babel.config.js","mtime":1580387978000},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1668956708481},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1668956821544}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIjsKaW1wb3J0IHsgZmV0Y2hDdXN0b21lciwgdXBkYXRlQ3VzdG9tZXIgfSBmcm9tICdAL2FwaS9jdXN0b21lcnMnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0NvbnRhY3RvckRldGFpbHMnLAogIGNvbXBvbmVudHM6IHsKICAgIEFkZENvbnRhY3RvckRpYWxvZzogZnVuY3Rpb24gQWRkQ29udGFjdG9yRGlhbG9nKCkgewogICAgICByZXR1cm4gaW1wb3J0KCcuL2FkZENvbnRhY3RvckRpYWxvZycpOwogICAgfSwKICAgIEFkZEFkZHJlc3NEaWFsb2c6IGZ1bmN0aW9uIEFkZEFkZHJlc3NEaWFsb2coKSB7CiAgICAgIHJldHVybiBpbXBvcnQoJy4vYWRkQWRkcmVzc0RpYWxvZycpOwogICAgfQogIH0sCiAgZmlsdGVyczogewogICAgc3RhdHVzRmlsdGVyOiBmdW5jdGlvbiBzdGF0dXNGaWx0ZXIoc3RhdHVzKSB7CiAgICAgIHZhciBzdGF0dXNNYXAgPSB7CiAgICAgICAgcHVibGlzaGVkOiAnc3VjY2VzcycsCiAgICAgICAgZHJhZnQ6ICdpbmZvJywKICAgICAgICBkZWxldGVkOiAnZGFuZ2VyJwogICAgICB9OwogICAgICByZXR1cm4gc3RhdHVzTWFwW3N0YXR1c107CiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbGlzdExvYWRpbmc6IGZhbHNlLAogICAgICBwcm92aW5jZXM6IFtdLAogICAgICBjaXRpZXM6IFtdLAogICAgICBkZXRhaWxzOiBudWxsLAogICAgICB0ZW1wOiB7CiAgICAgICAgY29udGFjdG9yczogW10sCiAgICAgICAgYWRkcmVzc2VzOiBbXQogICAgICB9LAogICAgICBydWxlczoge30sCiAgICAgIHVzZXJzOiBbXSwKICAgICAgaXNFZGl0OiBmYWxzZQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBpc0FkbWluUm9sZTogZnVuY3Rpb24gaXNBZG1pblJvbGUoKSB7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzLnJvbGVzLmluY2x1ZGVzKCdhZG1pbicpKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5mZXRjaERhdGEoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdvQmFjazogZnVuY3Rpb24gZ29CYWNrKCkgewogICAgICB0aGlzLiRyb3V0ZXIuZ28oLTEpOwogICAgfSwKICAgIGZldGNoRGF0YTogZnVuY3Rpb24gZmV0Y2hEYXRhKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB0aGlzLmxpc3RMb2FkaW5nID0gdHJ1ZTsKICAgICAgdmFyIGlkID0gdGhpcy4kcm91dGUucGFyYW1zICYmIHRoaXMuJHJvdXRlLnBhcmFtcy5pZDsKICAgICAgZmV0Y2hDdXN0b21lcihpZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpcy50ZW1wID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAvLyB0aGlzLmdldENpdGllc0xpc3RCeVByb3ZpbmNlSWQodGhpcy50ZW1wLnByb3ZpbmNlX2lkKQogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMubGlzdExvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9LCA1ICogMTAwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIGNvbmZpcm1FZGl0OiBmdW5jdGlvbiBjb25maXJtRWRpdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHRoaXMubGlzdExvYWRpbmcgPSB0cnVlOwogICAgICB2YXIgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMgJiYgdGhpcy4kcm91dGUucGFyYW1zLmlkOwogICAgICB1cGRhdGVDdXN0b21lcihpZCwgdGhpcy50ZW1wKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzMi50ZW1wID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMi5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sIDUgKiAxMDAwKTsKICAgICAgfSk7CiAgICAgIHRoaXMuaXNFZGl0ID0gIXRoaXMuaXNFZGl0OwogICAgfSwKICAgIGdldE5hbWVmcm9tT3B0aW9uczogZnVuY3Rpb24gZ2V0TmFtZWZyb21PcHRpb25zKG9wdGlvbnMsIGtleSkgewogICAgICAvLyByZXR1cm4gb3B0aW9uc1trZXldCiAgICAgIHZhciBzaG93bmFtZSA9ICcnOwogICAgICBvcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBpZiAoaXRlbS5rZXkgPT09IGtleSkgewogICAgICAgICAgLy8gY29uc29sZS5sb2coa2V5LCBpdGVtLmtleSwgaXRlbS5kaXNwbGF5X25hbWUpCiAgICAgICAgICBzaG93bmFtZSA9IGl0ZW0uZGlzcGxheV9uYW1lOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBzaG93bmFtZTsKICAgIH0sCiAgICBjYW5jZWxFZGl0OiBmdW5jdGlvbiBjYW5jZWxFZGl0KCkgewogICAgICB0aGlzLmlzRWRpdCA9ICF0aGlzLmlzRWRpdDsKICAgICAgdGhpcy5mZXRjaERhdGEoKTsKICAgIH0sCiAgICBnZXRTb3J0Q2xhc3M6IGZ1bmN0aW9uIGdldFNvcnRDbGFzcyhrZXkpIHsKICAgICAgdmFyIHNvcnQgPSB0aGlzLmxpc3RRdWVyeS5zb3J0OwogICAgICByZXR1cm4gc29ydCA9PT0gIisiLmNvbmNhdChrZXkpID8gJ2FzY2VuZGluZycgOiAnZGVzY2VuZGluZyc7CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;AA2JA;AAEA;EACAA;EACAC;IACAC;MAAA;IAAA;IACAC;MAAA;IAAA;EACA;EACAC;IACAC;MACA;QACAC;QACAC;QACAC;MACA;MACA;IACA;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACAC;MACA;QACA;MACA;QACA;MACA;IACA;EACA;EAEAC;IACA;EACA;EAEAC;IACAC;MACA;IACA;IAEAC;MAAA;MACA;MACA;MACAC;QACA;QACA;QACAC;UACA;QACA;MACA;IACA;IAEAC;MAAA;MACA;MACA;MACAC;QACA;QACAF;UACA;QACA;MACA;MACA;IACA;IAEAG;MACA;MACA;MACAC;QACA;UACA;UACAC;QACA;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;EACA;AACA","names":["name","components","AddContactorDialog","AddAddressDialog","filters","statusFilter","published","draft","deleted","data","listLoading","provinces","cities","details","temp","contactors","addresses","rules","users","isEdit","computed","isAdminRole","created","methods","goBack","fetchData","fetchCustomer","setTimeout","confirmEdit","updateCustomer","getNamefromOptions","options","showname","cancelEdit","getSortClass"],"sourceRoot":"src/views/dashboard/customers","sources":["Details.vue"],"sourcesContent":["<template>\r\n  <v-container fluid class=\"px-4 py-0\">\r\n    <template v-slot:after-heading> </template>\r\n    <v-card class=\"pt-5\" min-height=\"760px\">\r\n      <v-card-actions>\r\n        <v-spacer />\r\n\r\n        <v-btn v-show=\"!isEdit\" color=\"red\" @click=\"isEdit = !isEdit\"\r\n          >修改<v-icon right>mdi-text-box-edit</v-icon>\r\n        </v-btn>\r\n        <v-btn v-show=\"isEdit\" color=\"info\" @click=\"cancelEdit\"\r\n          ><v-icon>mdi-close-outline </v-icon></v-btn\r\n        >\r\n        <v-btn v-show=\"isEdit\" color=\"green\" @click=\"confirmEdit\"\r\n          ><v-icon text>mdi-check-outline</v-icon>\r\n        </v-btn>\r\n      </v-card-actions>\r\n      <div class=\"px-5 pb-5\">\r\n        <v-row>\r\n          <v-col cols=\"12\" sm=\"4\" md=\"4\">\r\n            <v-text-field\r\n              v-model=\"temp.name\"\r\n              color=\"yellow darken-3\"\r\n              label=\"客户名称\"\r\n              required\r\n              class=\"mx-6\"\r\n              :disabled=\"!isEdit\"\r\n              prepend-icon=\"mdi-account-search\"\r\n            ></v-text-field>\r\n          </v-col>\r\n          <v-col cols=\"12\" sm=\"4\" md=\"4\">\r\n            <v-text-field\r\n              v-model=\"temp.phone\"\r\n              color=\"yellow darken-3\"\r\n              label=\"公司电话\"\r\n              hint=\"请填写客户前台座机号码\"\r\n              required\r\n              class=\"mx-6\"\r\n              :disabled=\"!isEdit\"\r\n              prepend-icon=\"mdi-phone-classic\"\r\n            ></v-text-field>\r\n          </v-col>\r\n        </v-row>\r\n        <v-row>\r\n          <v-col>\r\n            <v-textarea\r\n              v-model=\"temp.description\"\r\n              color=\"yellow darken-3\"\r\n              label=\"主营业务、客户概况、合作意向\"\r\n              hint=\"\"\r\n              required\r\n              class=\"mx-6\"\r\n              :disabled=\"!isEdit\"\r\n              prepend-icon=\"mdi-text-search\"\r\n              auto-grow\r\n            ></v-textarea>\r\n          </v-col>\r\n        </v-row>\r\n\r\n        <v-row class=\"mx-5\">\r\n          <v-expansion-panels accordion>\r\n            <v-expansion-panel>\r\n              <v-expansion-panel-header>\r\n                <div>\r\n                  <span v-show=\"isEdit\">\r\n                    <add-contactor-dialog @fetchData=\"fetchData\"\r\n                  /></span>\r\n                  <v-icon left>mdi-account-circle</v-icon>\r\n\r\n                  <v-badge color=\"primary\" :content=\"temp.contactors.length\">\r\n                    联系人\r\n                  </v-badge>\r\n                </div>\r\n              </v-expansion-panel-header>\r\n\r\n              <v-expansion-panel-content>\r\n                <span v-for=\"(item, i) in temp.contactors\" :key=\"item.title\">\r\n                  <template>\r\n                    <v-list-item>\r\n                      <v-list-item-content>\r\n                        <v-list-item-title>\r\n                          <v-icon left color=\"primary\"\r\n                            >mdi-numeric-{{ i + 1 }}-circle-outline </v-icon\r\n                          >{{ item.name }}</v-list-item-title\r\n                        >\r\n                        <v-list-item-subtitle> </v-list-item-subtitle>\r\n                        <v-expansion-panel-content>\r\n                          MOB: {{ item.mobile }}; PHO: {{ item.phone }}; POS:\r\n                          {{ item.position }}; AGE: {{ item.age }}; SEX:\r\n                          {{ item.sex }}; EML:{{ item.email }}; WEC:\r\n                          {{ item.wechatid }}; EDU：{{ item.education_level }};\r\n                          SCH: {{ item.graduated_school }}; SPO:\r\n                          {{ item.spouse_detail }}; CHL:\r\n                          {{ item.child_detail }}; ADR：{{\r\n                            item.office_address\r\n                          }}; DES: {{ item.description }}\r\n                        </v-expansion-panel-content>\r\n                      </v-list-item-content>\r\n                    </v-list-item>\r\n                  </template>\r\n                </span>\r\n              </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n          </v-expansion-panels>\r\n\r\n          <v-expansion-panels accordion>\r\n            <v-expansion-panel>\r\n              <v-expansion-panel-header>\r\n                <div>\r\n                  <span v-show=\"isEdit\">\r\n                    <add-address-dialog @fetchData=\"fetchData\"\r\n                  /></span>\r\n                  <v-icon left>mdi-map-marker</v-icon>\r\n                  <v-badge color=\"blue\" :content=\"temp.addresses.length\">\r\n                    地址\r\n                  </v-badge>\r\n                </div>\r\n              </v-expansion-panel-header>\r\n\r\n              <v-expansion-panel-content>\r\n                <span v-for=\"(item, i) in temp.addresses\" :key=\"item.title\">\r\n                  <template>\r\n                    <v-list-item>\r\n                      <v-list-item-content>\r\n                        <v-list-item-title>\r\n                          <v-icon left color=\"blue\"\r\n                            >mdi-numeric-{{ i + 1 }}-circle-outline </v-icon\r\n                          >{{ item.department }}</v-list-item-title\r\n                        >\r\n                        <v-list-item-subtitle>\r\n                          {{ item.address_info }};{{ item.description }};\r\n                          {{ item.province.name }};{{\r\n                            item.city.name\r\n                          }}</v-list-item-subtitle\r\n                        >\r\n                      </v-list-item-content>\r\n                    </v-list-item>\r\n                  </template>\r\n                </span>\r\n              </v-expansion-panel-content>\r\n            </v-expansion-panel>\r\n          </v-expansion-panels>\r\n        </v-row>\r\n\r\n        <!-- <v-row v-show=\"isEdit\" class=\"mx-5 mt-12\">\r\n          <v-spacer></v-spacer>\r\n          <add-contactor-dialog />\r\n          <add-address-dialog />\r\n        </v-row> -->\r\n      </div>\r\n    </v-card>\r\n  </v-container>\r\n</template>\r\n\r\n<script>\r\nimport { fetchCustomer, updateCustomer } from '@/api/customers'\r\n\r\nexport default {\r\n  name: 'ContactorDetails',\r\n  components: {\r\n    AddContactorDialog: () => import('./addContactorDialog'),\r\n    AddAddressDialog: () => import('./addAddressDialog'),\r\n  },\r\n  filters: {\r\n    statusFilter(status) {\r\n      const statusMap = {\r\n        published: 'success',\r\n        draft: 'info',\r\n        deleted: 'danger',\r\n      }\r\n      return statusMap[status]\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      listLoading: false,\r\n      provinces: [],\r\n      cities: [],\r\n      details: null,\r\n      temp: {\r\n        contactors: [],\r\n        addresses: [],\r\n      },\r\n      rules: {},\r\n      users: [],\r\n      isEdit: false,\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    isAdminRole() {\r\n      if (this.$store.getters.roles.includes('admin')) {\r\n        return true\r\n      } else {\r\n        return false\r\n      }\r\n    },\r\n  },\r\n\r\n  created() {\r\n    this.fetchData()\r\n  },\r\n\r\n  methods: {\r\n    goBack() {\r\n      this.$router.go(-1)\r\n    },\r\n\r\n    fetchData() {\r\n      this.listLoading = true\r\n      const id = this.$route.params && this.$route.params.id\r\n      fetchCustomer(id).then(response => {\r\n        this.temp = response.data\r\n        // this.getCitiesListByProvinceId(this.temp.province_id)\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 5 * 1000)\r\n      })\r\n    },\r\n\r\n    confirmEdit() {\r\n      this.listLoading = true\r\n      const id = this.$route.params && this.$route.params.id\r\n      updateCustomer(id, this.temp).then(response => {\r\n        this.temp = response.data\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 5 * 1000)\r\n      })\r\n      this.isEdit = !this.isEdit\r\n    },\r\n\r\n    getNamefromOptions(options, key) {\r\n      // return options[key]\r\n      let showname = ''\r\n      options.forEach(item => {\r\n        if (item.key === key) {\r\n          // console.log(key, item.key, item.display_name)\r\n          showname = item.display_name\r\n        }\r\n      })\r\n      return showname\r\n    },\r\n\r\n    cancelEdit() {\r\n      this.isEdit = !this.isEdit\r\n      this.fetchData()\r\n    },\r\n\r\n    getSortClass: function(key) {\r\n      const sort = this.listQuery.sort\r\n      return sort === `+${key}` ? 'ascending' : 'descending'\r\n    },\r\n  },\r\n}\r\n</script>\r\n<style scoped>\r\n/* .v-overflow-btn .v-input__slot::before {\r\n  border-color: grey !important;\r\n} */\r\n</style>\r\n"]}]}