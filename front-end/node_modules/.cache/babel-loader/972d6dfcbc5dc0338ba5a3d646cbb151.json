{"remainingRequest":"D:\\mycode\\Yanei\\front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\visits\\addVisitDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\visits\\addVisitDialog.vue","mtime":1655702319825},{"path":"D:\\mycode\\Yanei\\front-end\\babel.config.js","mtime":1580387978000},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1668956708481},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1668956821544}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgY3JlYXRlVmlzaXQgfSBmcm9tICdAL2FwaS92aXNpdHMnOwppbXBvcnQgeyBmZXRjaEN1c3RvbWVyc0xpc3QsIGZldGNoQ29udGFjdG9yc0xpc3RieUN1c3RvbWVySWQsIGZldGNoQWRkcmVzc2VzTGlzdGJ5Q3VzdG9tZXJJZAovLyBmZXRjaFZpc2l0dHlwZXNMaXN0LAp9IGZyb20gJ0AvYXBpL3NlbGVjdGlvbnMnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0FkZFZpc2l0RGlhbG9nJywKICBjb21wb25lbnRzOiB7fSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY3VzdG9tZXJzOiBbXSwKICAgICAgY29udGFjdG9yczogW10sCiAgICAgIGFkZHJlc3NlczogW10sCiAgICAgIHZpc2l0dHlwZXM6IFtdLAogICAgICBkaWFsb2c6IGZhbHNlLAogICAgICBlZGl0ZGlhbG9nOiBmYWxzZSwKICAgICAgdGVtcDogewogICAgICAgIHRpdGxlOiAnJywKICAgICAgICBkZXNjcmlwdGlvbjogJycsCiAgICAgICAgdmlzaXR0eXBlX2lkOiAnJywKICAgICAgICBjdXN0b21lcl9pZDogJycsCiAgICAgICAgYWRkcmVzc19pZDogJycsCiAgICAgICAgY29udGFjdG9yaWRzOiBbXQogICAgICB9CiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIGlzVXBkYXRpbmc6IGZ1bmN0aW9uIGlzVXBkYXRpbmcodmFsKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIGlmICh2YWwpIHsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBfdGhpcy5pc1VwZGF0aW5nID0gZmFsc2U7CiAgICAgICAgfSwgMzAwMCk7CiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7fSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRDdXN0b21lcnNMaXN0KCk7CiAgICAvLyB0aGlzLmdldFZpc2l0dHlwZXNMaXN0KCkKICB9LAoKICBtZXRob2RzOiB7CiAgICBnZXRDdXN0b21lcnNMaXN0OiBmdW5jdGlvbiBnZXRDdXN0b21lcnNMaXN0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgZmV0Y2hDdXN0b21lcnNMaXN0KCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczIuY3VzdG9tZXJzID0gcmVzcG9uc2UuZGF0YS5pdGVtczsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMi5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sIDEuNSAqIDEwMDApOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRDb250YWN0b3JzTGlzdGJ5Q3VzdG9tZXJJZDogZnVuY3Rpb24gZ2V0Q29udGFjdG9yc0xpc3RieUN1c3RvbWVySWQoaWQpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIGZldGNoQ29udGFjdG9yc0xpc3RieUN1c3RvbWVySWQoaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMzLmNvbnRhY3RvcnMgPSByZXNwb25zZS5kYXRhLml0ZW1zOwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMzLmxpc3RMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfSwgMS41ICogMTAwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldEFkZHJlc3Nlc0xpc3RieUN1c3RvbWVySWQ6IGZ1bmN0aW9uIGdldEFkZHJlc3Nlc0xpc3RieUN1c3RvbWVySWQoaWQpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIGZldGNoQWRkcmVzc2VzTGlzdGJ5Q3VzdG9tZXJJZChpZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczQuYWRkcmVzc2VzID0gcmVzcG9uc2UuZGF0YS5pdGVtczsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzNC5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sIDEuNSAqIDEwMDApOwogICAgICB9KTsKICAgIH0sCiAgICAvLyBnZXRWaXNpdHR5cGVzTGlzdCgpIHsKICAgIC8vICAgZmV0Y2hWaXNpdHR5cGVzTGlzdCgpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgLy8gICAgIHRoaXMudmlzaXR0eXBlcyA9IHJlc3BvbnNlLmRhdGEuaXRlbXMKICAgIC8vICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgIC8vICAgICAgIHRoaXMubGlzdExvYWRpbmcgPSBmYWxzZQogICAgLy8gICAgIH0sIDEuNSAqIDEwMDApCiAgICAvLyAgIH0pCiAgICAvLyB9LAogICAgY29uZmlybUFkZERpYWxvZzogZnVuY3Rpb24gY29uZmlybUFkZERpYWxvZygpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7CiAgICAgIHZhciB0ZW1wRGF0YSA9IHRoaXMudGVtcDsKICAgICAgY3JlYXRlVmlzaXQodGVtcERhdGEpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNS5kaWFsb2cgPSBmYWxzZTsKICAgICAgICBfdGhpczUudGVtcCA9IHt9OwogICAgICAgIF90aGlzNS4kcGFyZW50LmdldExpc3QoKTsKICAgICAgfSk7CiAgICB9LAogICAgY2FuY2VsQWRkRGlhbG9nOiBmdW5jdGlvbiBjYW5jZWxBZGREaWFsb2coKSB7CiAgICAgIHRoaXMuZGlhbG9nID0gZmFsc2U7CiAgICAgIHRoaXMudGVtcCA9IHt9OwogICAgfSwKICAgIHVwZGF0ZUNvbnRhY3RvcnNBbmRBZGRyZXNzZXM6IGZ1bmN0aW9uIHVwZGF0ZUNvbnRhY3RvcnNBbmRBZGRyZXNzZXModmFsdWUsIGN1c3RvbWVySWQpIHsKICAgICAgdGhpcy5nZXRDb250YWN0b3JzTGlzdGJ5Q3VzdG9tZXJJZChjdXN0b21lcklkKTsKICAgICAgdGhpcy5nZXRBZGRyZXNzZXNMaXN0YnlDdXN0b21lcklkKGN1c3RvbWVySWQpOwogICAgfQogIH0KfTs="},{"version":3,"mappings":"AAsGA;AACA,SACAA,oBACAC,iCACAC;AACA;AAAA,OACA;AAEA;EACAC;EACAC;EAEAC;IAAA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;IACA;EAAA;EAEAC;IACAC;MAAA;MACA;QACAC;UAAA;QAAA;MACA;IACA;EACA;EACAC;EACAC;IACA;IACA;EACA;;EACAC;IACAC;MAAA;MACAzB;QACA;QACAqB;UACA;QACA;MACA;IACA;IAEAK;MAAA;MACAzB;QACA;QACAoB;UACA;QACA;MACA;IACA;IAEAM;MAAA;MACAzB;QACA;QACAmB;UACA;QACA;MACA;IACA;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAEAO;MAAA;MACA;MACAC;QACA;QACA;QACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;EACA;AACA","names":["fetchCustomersList","fetchContactorsListbyCustomerId","fetchAddressesListbyCustomerId","name","components","data","customers","contactors","addresses","visittypes","dialog","editdialog","temp","title","description","visittype_id","customer_id","address_id","contactorids","watch","isUpdating","setTimeout","mounted","created","methods","getCustomersList","getContactorsListbyCustomerId","getAddressesListbyCustomerId","confirmAddDialog","createVisit","cancelAddDialog","updateContactorsAndAddresses"],"sourceRoot":"src/views/dashboard/visits","sources":["addVisitDialog.vue"],"sourcesContent":["<template>\r\n  <v-dialog v-model=\"dialog\" max-width=\"1000\">\r\n    <template v-slot:activator=\"{ on, attrs }\">\r\n      <v-btn color=\"green\" dark v-bind=\"attrs\" class=\"mx-1 my-2\" v-on=\"on\">\r\n        新建 <v-icon right>mdi-plus</v-icon>\r\n      </v-btn>\r\n    </template>\r\n    <v-container fluid>\r\n      <v-card class=\"pt-10\">\r\n        <div class=\"px-6 pb-5\" height=\"800px\">\r\n          <v-card-title class=\"pb-10\"><h1>拜访日志</h1></v-card-title>\r\n          <v-row>\r\n            <v-col cols=\"12\" md=\"6\">\r\n              <v-autocomplete\r\n                v-model=\"temp.customer_id\"\r\n                :items=\"customers\"\r\n                item-text=\"name\"\r\n                item-value=\"id\"\r\n                label=\"客户名称\"\r\n                placeholder=\"选择公司或单位\"\r\n                prepend-icon=\"mdi-database-search\"\r\n                @change=\"\r\n                  event => updateContactorsAndAddresses(event, temp.customer_id)\r\n                \"\r\n              ></v-autocomplete\r\n            ></v-col>\r\n\r\n            <v-col cols=\"12\" md=\"3\"\r\n              ><v-autocomplete\r\n                v-model=\"temp.address_id\"\r\n                :items=\"addresses\"\r\n                item-text=\"name\"\r\n                item-value=\"id\"\r\n                label=\"地址\"\r\n                placeholder=\"本次拜访的客户地址\"\r\n                prepend-icon=\"mdi-account-search-outline\"\r\n              ></v-autocomplete\r\n            ></v-col>\r\n\r\n            <!-- <v-col cols=\"12\" md=\"3\">\r\n              <v-autocomplete\r\n                v-model=\"temp.visittype_id\"\r\n                :items=\"visittypes\"\r\n                item-text=\"name\"\r\n                item-value=\"id\"\r\n                label=\"拜访类型\"\r\n                placeholder=\"\"\r\n                prepend-icon=\"mdi-account-search-outline\"\r\n              ></v-autocomplete>\r\n            </v-col> -->\r\n            <!-- 拜访类型对应了审批流程，并决定了审批节点的数量和对应的审批团队和人员 -->\r\n          </v-row>\r\n          <v-row>\r\n            <v-col\r\n              ><v-autocomplete\r\n                v-model=\"temp.contactorids\"\r\n                :items=\"contactors\"\r\n                item-text=\"name\"\r\n                item-value=\"id\"\r\n                label=\"联系人\"\r\n                placeholder=\"本次拜访接待人员\"\r\n                prepend-icon=\"mdi-account-search-outline\"\r\n                multiple\r\n                chips\r\n              ></v-autocomplete\r\n            ></v-col>\r\n          </v-row>\r\n\r\n          <v-text-field\r\n            v-model=\"temp.title\"\r\n            color=\"yellow darken-3\"\r\n            label=\"标题\"\r\n            hint=\"简述此次拜访目的和内容\"\r\n            required\r\n          ></v-text-field>\r\n          <v-textarea\r\n            v-model=\"temp.description\"\r\n            color=\"yellow darken-3\"\r\n            label=\"描述拜访经过和成果\"\r\n            hint=\"\"\r\n            required\r\n            auto-grow\r\n          ></v-textarea>\r\n\r\n          <v-row>\r\n            <v-spacer></v-spacer>\r\n            <span class=\"mt-6 mx-3\" style=\"font-size:14px\">\r\n              技术支持<span class=\"yanei ml-1 mr-7\">研一智控</span>\r\n            </span>\r\n          </v-row>\r\n          <v-card-actions>\r\n            <v-spacer></v-spacer>\r\n            <v-btn color=\"primary\" @click=\"cancelAddDialog\">取消</v-btn>\r\n            <v-btn color=\"primary\" @click=\"confirmAddDialog\">确认</v-btn>\r\n          </v-card-actions>\r\n        </div>\r\n      </v-card>\r\n    </v-container>\r\n  </v-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { createVisit } from '@/api/visits'\r\nimport {\r\n  fetchCustomersList,\r\n  fetchContactorsListbyCustomerId,\r\n  fetchAddressesListbyCustomerId,\r\n  // fetchVisittypesList,\r\n} from '@/api/selections'\r\n\r\nexport default {\r\n  name: 'AddVisitDialog',\r\n  components: {},\r\n\r\n  data: () => ({\r\n    customers: [],\r\n    contactors: [],\r\n    addresses: [],\r\n    visittypes: [],\r\n    dialog: false,\r\n    editdialog: false,\r\n    temp: {\r\n      title: '',\r\n      description: '',\r\n      visittype_id: '',\r\n      customer_id: '',\r\n      address_id: '',\r\n      contactorids: [],\r\n    },\r\n  }),\r\n\r\n  watch: {\r\n    isUpdating(val) {\r\n      if (val) {\r\n        setTimeout(() => (this.isUpdating = false), 3000)\r\n      }\r\n    },\r\n  },\r\n  mounted() {},\r\n  created() {\r\n    this.getCustomersList()\r\n    // this.getVisittypesList()\r\n  },\r\n  methods: {\r\n    getCustomersList() {\r\n      fetchCustomersList().then(response => {\r\n        this.customers = response.data.items\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 1.5 * 1000)\r\n      })\r\n    },\r\n\r\n    getContactorsListbyCustomerId(id) {\r\n      fetchContactorsListbyCustomerId(id).then(response => {\r\n        this.contactors = response.data.items\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 1.5 * 1000)\r\n      })\r\n    },\r\n\r\n    getAddressesListbyCustomerId(id) {\r\n      fetchAddressesListbyCustomerId(id).then(response => {\r\n        this.addresses = response.data.items\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 1.5 * 1000)\r\n      })\r\n    },\r\n\r\n    // getVisittypesList() {\r\n    //   fetchVisittypesList().then(response => {\r\n    //     this.visittypes = response.data.items\r\n    //     setTimeout(() => {\r\n    //       this.listLoading = false\r\n    //     }, 1.5 * 1000)\r\n    //   })\r\n    // },\r\n\r\n    confirmAddDialog() {\r\n      const tempData = this.temp\r\n      createVisit(tempData).then(() => {\r\n        this.dialog = false\r\n        this.temp = {}\r\n        this.$parent.getList()\r\n      })\r\n    },\r\n\r\n    cancelAddDialog() {\r\n      this.dialog = false\r\n      this.temp = {}\r\n    },\r\n\r\n    updateContactorsAndAddresses(value, customerId) {\r\n      this.getContactorsListbyCustomerId(customerId)\r\n      this.getAddressesListbyCustomerId(customerId)\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\"></style>\r\n"]}]}