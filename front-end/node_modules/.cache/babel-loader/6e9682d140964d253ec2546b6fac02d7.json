{"remainingRequest":"D:\\mycode\\Yanei\\front-end\\node_modules\\babel-loader\\lib\\index.js!D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\settings\\users.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\settings\\users.vue","mtime":1655109872678},{"path":"D:\\mycode\\Yanei\\front-end\\babel.config.js","mtime":1580387978000},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1668956708481},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1668956821544}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgeyBmZXRjaFVzZXJzLCBkZWxldGVVc2VyIH0gZnJvbSAnQC9hcGkvdXNlcnMnOwp2YXIgdXNlclN0YXR1c09wdGlvbnMgPSBbewogIGtleTogMCwKICBkaXNwbGF5X25hbWU6ICflvoXlrqHmoLgnCn0sIHsKICBrZXk6IDEsCiAgZGlzcGxheV9uYW1lOiAn5q2j5bi4Jwp9LCB7CiAga2V5OiAyLAogIGRpc3BsYXlfbmFtZTogJ+acqumAmui/hycKfSwgewogIGtleTogMywKICBkaXNwbGF5X25hbWU6ICfpqbPlm54nCn1dOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1VzZXJzJywKICBjb21wb25lbnRzOiB7fSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc25hY2tiYXI6IGZhbHNlLAogICAgICB0ZXh0OiAnJywKICAgICAgdGltZW91dDogMzAwMCwKICAgICAgYWN0aW9uOiB7CiAgICAgICAgY29sb3I6ICdpbmZvJywKICAgICAgICBpY29uOiAnbWRpLWJsdXInCiAgICAgIH0sCiAgICAgIGl0ZW1zOiBbXSwKICAgICAgbGlzdFF1ZXJ5OiB7CiAgICAgICAgcGFnZTogMSwKICAgICAgICBsaW1pdDogMTAwLAogICAgICAgIG5hbWU6IHVuZGVmaW5lZCwKICAgICAgICBzdGF0dXM6IHVuZGVmaW5lZCwKICAgICAgICBzb3J0OiAnK2lkJwogICAgICB9LAogICAgICAvLyBzZWFyY2g6IHVuZGVmaW5lZCwKICAgICAgdXNlclN0YXR1c09wdGlvbnM6IHVzZXJTdGF0dXNPcHRpb25zLAogICAgICBjaXJjbGU6IHRydWUsCiAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgbGVuZ3RoOiAxMCwKICAgICAgbmV4dEljb246ICdtZGktY2hldnJvbi1yaWdodCcsCiAgICAgIHByZXZJY29uOiAnbWRpLWNoZXZyb24tbGVmdCcsCiAgICAgIHRvdGFsVmlzaWJsZTogMTAsCiAgICAgIHRvdGFsX3BhZ2VzOiAwCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlzQWRtaW5Sb2xlOiBmdW5jdGlvbiBpc0FkbWluUm9sZSgpIHsKICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnMucm9sZXMuaW5jbHVkZXMoJ2FkbWluJykpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBzZWFyY2g6IGZ1bmN0aW9uIHNlYXJjaCh2YWwpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgaWYgKCF0aGlzLmF3YWl0aW5nU2VhcmNoKSB7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpcy5nZXRMaXN0KCk7CiAgICAgICAgICBfdGhpcy5hd2FpdGluZ1NlYXJjaCA9IGZhbHNlOwogICAgICAgIH0sIDYwMDApOyAvLyAxIHNlYyBkZWxheQogICAgICB9CgogICAgICB0aGlzLmF3YWl0aW5nU2VhcmNoID0gdHJ1ZTsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldExpc3QoKTsKICAgIC8vIGNvbnNvbGUubG9nKCkKICB9LAoKICBtZXRob2RzOiB7CiAgICBnZXRRdWVyeTogZnVuY3Rpb24gZ2V0UXVlcnkoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLmdldExpc3QoKTsKICAgICAgfSwgNTAwKTsKICAgIH0sCiAgICBnZXRMaXN0OiBmdW5jdGlvbiBnZXRMaXN0KCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgdGhpcy5saXN0TG9hZGluZyA9IHRydWU7CiAgICAgIGZldGNoVXNlcnModGhpcy5saXN0UXVlcnkpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMzLml0ZW1zID0gcmVzcG9uc2UuZGF0YS5pdGVtczsKICAgICAgICBfdGhpczMudG90YWxfcGFnZXMgPSByZXNwb25zZS5kYXRhLl9tZXRhLnRvdGFsX3BhZ2VzOwogICAgICAgIGNvbnNvbGUubG9nKF90aGlzMy5pdGVtcyk7CgogICAgICAgIC8vIEp1c3QgdG8gc2ltdWxhdGUgdGhlIHRpbWUgb2YgdGhlIHJlcXVlc3QKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMy5saXN0TG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0sIDEuNSAqIDEwMDApOwogICAgICB9KTsKICAgIH0sCiAgICBoYW5kbGVUb0RldGFpbHM6IGZ1bmN0aW9uIGhhbmRsZVRvRGV0YWlscyhyb3cpIHsKICAgICAgLy8gY29uc29sZS5sb2cocm93LmlkKQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ+ivu+iAheivpuaDhScsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBpZDogcm93LmlkCiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZW1vdmVBdXRob3I6IGZ1bmN0aW9uIHJlbW92ZUF1dGhvcihyb3cpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+ehruiupOWIoOmZpOivu+iAhei0puWPtz8nKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICBkZWxldGVVc2VyKHJvdy5pZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgX3RoaXM0LmdldExpc3QoKTsKICAgICAgICAgICAgLy8gSnVzdCB0byBzaW11bGF0ZSB0aGUgdGltZSBvZiB0aGUgcmVxdWVzdAogICAgICAgICAgICBfdGhpczQudGV4dCA9ICfkvZzogIXliKDpmaTmiJDlip/vvIEnOwogICAgICAgICAgICBfdGhpczQuc25hY2tiYXIgPSB0cnVlOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBnZXROYW1lZnJvbU9wdGlvbnM6IGZ1bmN0aW9uIGdldE5hbWVmcm9tT3B0aW9ucyhvcHRpb25zLCBrZXkpIHsKICAgICAgLy8gcmV0dXJuIG9wdGlvbnNba2V5XQogICAgICB2YXIgc2hvd25hbWUgPSAnJzsKICAgICAgb3B0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0ua2V5ID09PSBrZXkpIHsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGtleSwgaXRlbS5rZXksIGl0ZW0uZGlzcGxheV9uYW1lKQogICAgICAgICAgc2hvd25hbWUgPSBpdGVtLmRpc3BsYXlfbmFtZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gc2hvd25hbWU7CiAgICB9LAogICAgcGFnaW5hdGlvbkNoYW5nZUhhbmRsZXI6IGZ1bmN0aW9uIHBhZ2luYXRpb25DaGFuZ2VIYW5kbGVyKHBhZ2VOdW1iZXIpIHsKICAgICAgdGhpcy5saXN0UXVlcnkucGFnZSA9IHBhZ2VOdW1iZXI7CiAgICAgIHRoaXMuZ2V0TGlzdCgpOwogICAgfSwKICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHsKICAgICAgdGhpcy4kcmVmcy5mb3JtLnJlc2V0KCk7CiAgICB9LAogICAgcmVzZXRWYWxpZGF0aW9uOiBmdW5jdGlvbiByZXNldFZhbGlkYXRpb24oKSB7CiAgICAgIHRoaXMuJHJlZnMuZm9ybS5yZXNldFZhbGlkYXRpb24oKTsKICAgIH0KICB9Cn07"},{"version":3,"mappings":";;;;;AA4FA;AAEA,yBACA;EAAAA;EAAAC;AAAA,GACA;EAAAD;EAAAC;AAAA,GACA;EAAAD;EAAAC;AAAA,GACA;EAAAD;EAAAC;AAAA,EACA;AAEA;EACAC;EAEAC;EAEAC;IAAA;MACAC;MACAC;MACAC;MAEAC;QACAC;QACAC;MACA;MACAC;MACAC;QACAC;QACAC;QACAZ;QACAa;QACAC;MACA;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EAAA;EACAC;IACAC;MACA;QACA;MACA;QACA;MACA;IACA;EACA;EACAC;IACAC;MAAA;MACA;QACAC;UACA;UACA;QACA;MACA;;MACA;IACA;EACA;EACAC;IACA;IACA;EACA;;EACAC;IACAC;MAAA;MACAH;QAAA;MAAA;IACA;IACAI;MAAA;MACA;MACAC;QACA;QACA;QACAC;;QAEA;QACAN;UACA;QACA;MACA;IACA;IACAO;MACA;MACA;QACAlC;QACAmC;UAAAC;QAAA;MACA;IACA;IACAC;MAAA;MACA;QACA;UACAC;YACA;YACA;YACA;YACA;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACAC;QACA;UACA;UACAC;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;EACA;AACA","names":["key","display_name","name","components","data","snackbar","text","timeout","action","color","icon","items","listQuery","page","limit","status","sort","userStatusOptions","circle","disabled","length","nextIcon","prevIcon","totalVisible","total_pages","computed","isAdminRole","watch","search","setTimeout","created","methods","getQuery","getList","fetchUsers","console","handleToDetails","params","id","removeAuthor","deleteUser","getNamefromOptions","options","showname","paginationChangeHandler","reset","resetValidation"],"sourceRoot":"src/views/dashboard/settings","sources":["users.vue"],"sourcesContent":["<template>\n  <v-container fluid class=\"px-4 py-0\">\n    <template v-slot:after-heading> </template>\n    <v-row class=\"d-flex justify-space-between mx-1 mb-5\">\n      <v-col cols=\"6\" md=\"10\">\n        <v-text-field\n          v-model=\"listQuery.name\"\n          append-icon=\"mdi-magnify\"\n          class=\"ml-auto\"\n          label=\"Search: 登录名，姓名，微信昵称\"\n          hide-details\n          single-line\n          style=\"max-width: 360px;\"\n        />\n      </v-col>\n      <!-- <v-col cols=\"6\" md=\"2\">\n          <AddBookDialog />\n        </v-col> -->\n    </v-row>\n\n    <v-divider class=\"mt-3\" />\n\n    <v-simple-table fixed-header class=\"pa-3\">\n      <template v-slot:default>\n        <thead>\n          <tr>\n            <th>ID</th>\n            <th>账号</th>\n            <th>用户名称</th>\n            <th>角色</th>\n            <th class=\"text-right\">活跃指数</th>\n            <th>手机号码</th>\n            <th>状态</th>\n            <th>创建时间</th>\n            <th>最后一次访问</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"row in items\" :key=\"row.id\">\n            <td>\n              {{ row.id }}\n            </td>\n            <td>\n              {{ row.username ? row.username : '-' }}\n            </td>\n            <td>{{ row.name ? row.name : '-' }}</td>\n            <td>\n              {{ row.role.name ? row.role.name : '-' }}\n            </td>\n            <td class=\"text-right\">\n              {{ row.login_counts }}\n            </td>\n            <td>\n              {{ row.phone ? row.phone : '-' }}\n            </td>\n            <td>\n              {{ getNamefromOptions(userStatusOptions, row.status_code) }}\n            </td>\n\n            <td>\n              {{ $moment(row.member_since).format('YYYY-MM-DD HH:mm:ss') }}\n            </td>\n            <td>\n              {{ $moment(row.last_seen).fromNow() }}\n            </td>\n          </tr>\n        </tbody>\n      </template>\n    </v-simple-table>\n    <div class=\"text-center\">\n      <v-row justify=\"center\" align=\"center\">\n        <v-pagination\n          v-model=\"listQuery.page\"\n          :circle=\"circle\"\n          :disabled=\"disabled\"\n          :length=\"total_pages\"\n          :next-icon=\"nextIcon\"\n          :prev-icon=\"prevIcon\"\n          :total-visible=\"totalVisible\"\n          :value=\"listQuery.page\"\n          @input=\"paginationChangeHandler\"\n        ></v-pagination>\n        <!-- <span>共{{total_pages}}页</span> -->\n      </v-row>\n    </div>\n    <v-snackbar v-model=\"snackbar\" :timeout=\"timeout\">\n      {{ text }}\n    </v-snackbar>\n  </v-container>\n</template>\n\n<script>\nimport { fetchUsers, deleteUser } from '@/api/users'\n\nconst userStatusOptions = [\n  { key: 0, display_name: '待审核' },\n  { key: 1, display_name: '正常' },\n  { key: 2, display_name: '未通过' },\n  { key: 3, display_name: '驳回' },\n]\n\nexport default {\n  name: 'Users',\n\n  components: {},\n\n  data: () => ({\n    snackbar: false,\n    text: '',\n    timeout: 3000,\n\n    action: {\n      color: 'info',\n      icon: 'mdi-blur',\n    },\n    items: [],\n    listQuery: {\n      page: 1,\n      limit: 100,\n      name: undefined,\n      status: undefined,\n      sort: '+id',\n    },\n    // search: undefined,\n    userStatusOptions,\n    circle: true,\n    disabled: false,\n    length: 10,\n    nextIcon: 'mdi-chevron-right',\n    prevIcon: 'mdi-chevron-left',\n    totalVisible: 10,\n    total_pages: 0,\n  }),\n  computed: {\n    isAdminRole() {\n      if (this.$store.getters.roles.includes('admin')) {\n        return true\n      } else {\n        return false\n      }\n    },\n  },\n  watch: {\n    search: function(val) {\n      if (!this.awaitingSearch) {\n        setTimeout(() => {\n          this.getList()\n          this.awaitingSearch = false\n        }, 6000) // 1 sec delay\n      }\n      this.awaitingSearch = true\n    },\n  },\n  created() {\n    this.getList()\n    // console.log()\n  },\n  methods: {\n    getQuery() {\n      setTimeout(() => this.getList(), 500)\n    },\n    getList() {\n      this.listLoading = true\n      fetchUsers(this.listQuery).then(response => {\n        this.items = response.data.items\n        this.total_pages = response.data._meta.total_pages\n        console.log(this.items)\n\n        // Just to simulate the time of the request\n        setTimeout(() => {\n          this.listLoading = false\n        }, 1.5 * 1000)\n      })\n    },\n    handleToDetails(row) {\n      // console.log(row.id)\n      this.$router.push({\n        name: '读者详情',\n        params: { id: row.id },\n      })\n    },\n    removeAuthor(row) {\n      this.$confirm('确认删除读者账号?').then(res => {\n        if (res) {\n          deleteUser(row.id).then(response => {\n            this.getList()\n            // Just to simulate the time of the request\n            this.text = '作者删除成功！'\n            this.snackbar = true\n          })\n        }\n      })\n    },\n    getNamefromOptions(options, key) {\n      // return options[key]\n      let showname = ''\n      options.forEach(item => {\n        if (item.key === key) {\n          // console.log(key, item.key, item.display_name)\n          showname = item.display_name\n        }\n      })\n      return showname\n    },\n    paginationChangeHandler(pageNumber) {\n      this.listQuery.page = pageNumber\n      this.getList()\n    },\n    reset() {\n      this.$refs.form.reset()\n    },\n    resetValidation() {\n      this.$refs.form.resetValidation()\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\nth {\n  font-size: 12px !important;\n  font-weight: 600 !important;\n}\n\ntr:hover {\n  background-color: #43b4dd !important;\n  color: rgb(255, 255, 255);\n}\n</style>\n"]}]}