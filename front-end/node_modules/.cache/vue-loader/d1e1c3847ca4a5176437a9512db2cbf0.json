{"remainingRequest":"D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\settings\\users.vue?vue&type=style&index=0&id=677626de&lang=scss&scoped=true&","dependencies":[{"path":"D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\settings\\users.vue","mtime":1655109872678},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\css-loader\\dist\\cjs.js","mtime":1668956816130},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1668956821544},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\postcss-loader\\src\\index.js","mtime":1668947866669},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1668956894014},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1668956821544}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CnRoIHsKICBmb250LXNpemU6IDEycHggIWltcG9ydGFudDsKICBmb250LXdlaWdodDogNjAwICFpbXBvcnRhbnQ7Cn0KCnRyOmhvdmVyIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjNDNiNGRkICFpbXBvcnRhbnQ7CiAgY29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTsKfQo="},{"version":3,"sources":["users.vue"],"names":[],"mappings":";AA2NA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"users.vue","sourceRoot":"src/views/dashboard/settings","sourcesContent":["<template>\n  <v-container fluid class=\"px-4 py-0\">\n    <template v-slot:after-heading> </template>\n    <v-row class=\"d-flex justify-space-between mx-1 mb-5\">\n      <v-col cols=\"6\" md=\"10\">\n        <v-text-field\n          v-model=\"listQuery.name\"\n          append-icon=\"mdi-magnify\"\n          class=\"ml-auto\"\n          label=\"Search: 登录名，姓名，微信昵称\"\n          hide-details\n          single-line\n          style=\"max-width: 360px;\"\n        />\n      </v-col>\n      <!-- <v-col cols=\"6\" md=\"2\">\n          <AddBookDialog />\n        </v-col> -->\n    </v-row>\n\n    <v-divider class=\"mt-3\" />\n\n    <v-simple-table fixed-header class=\"pa-3\">\n      <template v-slot:default>\n        <thead>\n          <tr>\n            <th>ID</th>\n            <th>账号</th>\n            <th>用户名称</th>\n            <th>角色</th>\n            <th class=\"text-right\">活跃指数</th>\n            <th>手机号码</th>\n            <th>状态</th>\n            <th>创建时间</th>\n            <th>最后一次访问</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-for=\"row in items\" :key=\"row.id\">\n            <td>\n              {{ row.id }}\n            </td>\n            <td>\n              {{ row.username ? row.username : '-' }}\n            </td>\n            <td>{{ row.name ? row.name : '-' }}</td>\n            <td>\n              {{ row.role.name ? row.role.name : '-' }}\n            </td>\n            <td class=\"text-right\">\n              {{ row.login_counts }}\n            </td>\n            <td>\n              {{ row.phone ? row.phone : '-' }}\n            </td>\n            <td>\n              {{ getNamefromOptions(userStatusOptions, row.status_code) }}\n            </td>\n\n            <td>\n              {{ $moment(row.member_since).format('YYYY-MM-DD HH:mm:ss') }}\n            </td>\n            <td>\n              {{ $moment(row.last_seen).fromNow() }}\n            </td>\n          </tr>\n        </tbody>\n      </template>\n    </v-simple-table>\n    <div class=\"text-center\">\n      <v-row justify=\"center\" align=\"center\">\n        <v-pagination\n          v-model=\"listQuery.page\"\n          :circle=\"circle\"\n          :disabled=\"disabled\"\n          :length=\"total_pages\"\n          :next-icon=\"nextIcon\"\n          :prev-icon=\"prevIcon\"\n          :total-visible=\"totalVisible\"\n          :value=\"listQuery.page\"\n          @input=\"paginationChangeHandler\"\n        ></v-pagination>\n        <!-- <span>共{{total_pages}}页</span> -->\n      </v-row>\n    </div>\n    <v-snackbar v-model=\"snackbar\" :timeout=\"timeout\">\n      {{ text }}\n    </v-snackbar>\n  </v-container>\n</template>\n\n<script>\nimport { fetchUsers, deleteUser } from '@/api/users'\n\nconst userStatusOptions = [\n  { key: 0, display_name: '待审核' },\n  { key: 1, display_name: '正常' },\n  { key: 2, display_name: '未通过' },\n  { key: 3, display_name: '驳回' },\n]\n\nexport default {\n  name: 'Users',\n\n  components: {},\n\n  data: () => ({\n    snackbar: false,\n    text: '',\n    timeout: 3000,\n\n    action: {\n      color: 'info',\n      icon: 'mdi-blur',\n    },\n    items: [],\n    listQuery: {\n      page: 1,\n      limit: 100,\n      name: undefined,\n      status: undefined,\n      sort: '+id',\n    },\n    // search: undefined,\n    userStatusOptions,\n    circle: true,\n    disabled: false,\n    length: 10,\n    nextIcon: 'mdi-chevron-right',\n    prevIcon: 'mdi-chevron-left',\n    totalVisible: 10,\n    total_pages: 0,\n  }),\n  computed: {\n    isAdminRole() {\n      if (this.$store.getters.roles.includes('admin')) {\n        return true\n      } else {\n        return false\n      }\n    },\n  },\n  watch: {\n    search: function(val) {\n      if (!this.awaitingSearch) {\n        setTimeout(() => {\n          this.getList()\n          this.awaitingSearch = false\n        }, 6000) // 1 sec delay\n      }\n      this.awaitingSearch = true\n    },\n  },\n  created() {\n    this.getList()\n    // console.log()\n  },\n  methods: {\n    getQuery() {\n      setTimeout(() => this.getList(), 500)\n    },\n    getList() {\n      this.listLoading = true\n      fetchUsers(this.listQuery).then(response => {\n        this.items = response.data.items\n        this.total_pages = response.data._meta.total_pages\n        console.log(this.items)\n\n        // Just to simulate the time of the request\n        setTimeout(() => {\n          this.listLoading = false\n        }, 1.5 * 1000)\n      })\n    },\n    handleToDetails(row) {\n      // console.log(row.id)\n      this.$router.push({\n        name: '读者详情',\n        params: { id: row.id },\n      })\n    },\n    removeAuthor(row) {\n      this.$confirm('确认删除读者账号?').then(res => {\n        if (res) {\n          deleteUser(row.id).then(response => {\n            this.getList()\n            // Just to simulate the time of the request\n            this.text = '作者删除成功！'\n            this.snackbar = true\n          })\n        }\n      })\n    },\n    getNamefromOptions(options, key) {\n      // return options[key]\n      let showname = ''\n      options.forEach(item => {\n        if (item.key === key) {\n          // console.log(key, item.key, item.display_name)\n          showname = item.display_name\n        }\n      })\n      return showname\n    },\n    paginationChangeHandler(pageNumber) {\n      this.listQuery.page = pageNumber\n      this.getList()\n    },\n    reset() {\n      this.$refs.form.reset()\n    },\n    resetValidation() {\n      this.$refs.form.resetValidation()\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\" scoped>\nth {\n  font-size: 12px !important;\n  font-weight: 600 !important;\n}\n\ntr:hover {\n  background-color: #43b4dd !important;\n  color: rgb(255, 255, 255);\n}\n</style>\n"]}]}