{"remainingRequest":"D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\visits\\addVisitDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\mycode\\Yanei\\front-end\\src\\views\\dashboard\\visits\\addVisitDialog.vue","mtime":1655702319825},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\babel-loader\\lib\\index.js","mtime":1668956708481},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668947705996},{"path":"D:\\mycode\\Yanei\\front-end\\node_modules\\vue-loader\\lib\\index.js","mtime":1668956821544}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBjcmVhdGVWaXNpdCB9IGZyb20gJ0AvYXBpL3Zpc2l0cycNCmltcG9ydCB7DQogIGZldGNoQ3VzdG9tZXJzTGlzdCwNCiAgZmV0Y2hDb250YWN0b3JzTGlzdGJ5Q3VzdG9tZXJJZCwNCiAgZmV0Y2hBZGRyZXNzZXNMaXN0YnlDdXN0b21lcklkLA0KICAvLyBmZXRjaFZpc2l0dHlwZXNMaXN0LA0KfSBmcm9tICdAL2FwaS9zZWxlY3Rpb25zJw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdBZGRWaXNpdERpYWxvZycsDQogIGNvbXBvbmVudHM6IHt9LA0KDQogIGRhdGE6ICgpID0+ICh7DQogICAgY3VzdG9tZXJzOiBbXSwNCiAgICBjb250YWN0b3JzOiBbXSwNCiAgICBhZGRyZXNzZXM6IFtdLA0KICAgIHZpc2l0dHlwZXM6IFtdLA0KICAgIGRpYWxvZzogZmFsc2UsDQogICAgZWRpdGRpYWxvZzogZmFsc2UsDQogICAgdGVtcDogew0KICAgICAgdGl0bGU6ICcnLA0KICAgICAgZGVzY3JpcHRpb246ICcnLA0KICAgICAgdmlzaXR0eXBlX2lkOiAnJywNCiAgICAgIGN1c3RvbWVyX2lkOiAnJywNCiAgICAgIGFkZHJlc3NfaWQ6ICcnLA0KICAgICAgY29udGFjdG9yaWRzOiBbXSwNCiAgICB9LA0KICB9KSwNCg0KICB3YXRjaDogew0KICAgIGlzVXBkYXRpbmcodmFsKSB7DQogICAgICBpZiAodmFsKSB7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gKHRoaXMuaXNVcGRhdGluZyA9IGZhbHNlKSwgMzAwMCkNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KICBtb3VudGVkKCkge30sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5nZXRDdXN0b21lcnNMaXN0KCkNCiAgICAvLyB0aGlzLmdldFZpc2l0dHlwZXNMaXN0KCkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGdldEN1c3RvbWVyc0xpc3QoKSB7DQogICAgICBmZXRjaEN1c3RvbWVyc0xpc3QoKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgdGhpcy5jdXN0b21lcnMgPSByZXNwb25zZS5kYXRhLml0ZW1zDQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgIHRoaXMubGlzdExvYWRpbmcgPSBmYWxzZQ0KICAgICAgICB9LCAxLjUgKiAxMDAwKQ0KICAgICAgfSkNCiAgICB9LA0KDQogICAgZ2V0Q29udGFjdG9yc0xpc3RieUN1c3RvbWVySWQoaWQpIHsNCiAgICAgIGZldGNoQ29udGFjdG9yc0xpc3RieUN1c3RvbWVySWQoaWQpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICB0aGlzLmNvbnRhY3RvcnMgPSByZXNwb25zZS5kYXRhLml0ZW1zDQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgIHRoaXMubGlzdExvYWRpbmcgPSBmYWxzZQ0KICAgICAgICB9LCAxLjUgKiAxMDAwKQ0KICAgICAgfSkNCiAgICB9LA0KDQogICAgZ2V0QWRkcmVzc2VzTGlzdGJ5Q3VzdG9tZXJJZChpZCkgew0KICAgICAgZmV0Y2hBZGRyZXNzZXNMaXN0YnlDdXN0b21lcklkKGlkKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgdGhpcy5hZGRyZXNzZXMgPSByZXNwb25zZS5kYXRhLml0ZW1zDQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgIHRoaXMubGlzdExvYWRpbmcgPSBmYWxzZQ0KICAgICAgICB9LCAxLjUgKiAxMDAwKQ0KICAgICAgfSkNCiAgICB9LA0KDQogICAgLy8gZ2V0VmlzaXR0eXBlc0xpc3QoKSB7DQogICAgLy8gICBmZXRjaFZpc2l0dHlwZXNMaXN0KCkudGhlbihyZXNwb25zZSA9PiB7DQogICAgLy8gICAgIHRoaXMudmlzaXR0eXBlcyA9IHJlc3BvbnNlLmRhdGEuaXRlbXMNCiAgICAvLyAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgLy8gICAgICAgdGhpcy5saXN0TG9hZGluZyA9IGZhbHNlDQogICAgLy8gICAgIH0sIDEuNSAqIDEwMDApDQogICAgLy8gICB9KQ0KICAgIC8vIH0sDQoNCiAgICBjb25maXJtQWRkRGlhbG9nKCkgew0KICAgICAgY29uc3QgdGVtcERhdGEgPSB0aGlzLnRlbXANCiAgICAgIGNyZWF0ZVZpc2l0KHRlbXBEYXRhKS50aGVuKCgpID0+IHsNCiAgICAgICAgdGhpcy5kaWFsb2cgPSBmYWxzZQ0KICAgICAgICB0aGlzLnRlbXAgPSB7fQ0KICAgICAgICB0aGlzLiRwYXJlbnQuZ2V0TGlzdCgpDQogICAgICB9KQ0KICAgIH0sDQoNCiAgICBjYW5jZWxBZGREaWFsb2coKSB7DQogICAgICB0aGlzLmRpYWxvZyA9IGZhbHNlDQogICAgICB0aGlzLnRlbXAgPSB7fQ0KICAgIH0sDQoNCiAgICB1cGRhdGVDb250YWN0b3JzQW5kQWRkcmVzc2VzKHZhbHVlLCBjdXN0b21lcklkKSB7DQogICAgICB0aGlzLmdldENvbnRhY3RvcnNMaXN0YnlDdXN0b21lcklkKGN1c3RvbWVySWQpDQogICAgICB0aGlzLmdldEFkZHJlc3Nlc0xpc3RieUN1c3RvbWVySWQoY3VzdG9tZXJJZCkNCiAgICB9LA0KICB9LA0KfQ0K"},{"version":3,"sources":["addVisitDialog.vue"],"names":[],"mappings":";AAsGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"addVisitDialog.vue","sourceRoot":"src/views/dashboard/visits","sourcesContent":["<template>\r\n  <v-dialog v-model=\"dialog\" max-width=\"1000\">\r\n    <template v-slot:activator=\"{ on, attrs }\">\r\n      <v-btn color=\"green\" dark v-bind=\"attrs\" class=\"mx-1 my-2\" v-on=\"on\">\r\n        新建 <v-icon right>mdi-plus</v-icon>\r\n      </v-btn>\r\n    </template>\r\n    <v-container fluid>\r\n      <v-card class=\"pt-10\">\r\n        <div class=\"px-6 pb-5\" height=\"800px\">\r\n          <v-card-title class=\"pb-10\"><h1>拜访日志</h1></v-card-title>\r\n          <v-row>\r\n            <v-col cols=\"12\" md=\"6\">\r\n              <v-autocomplete\r\n                v-model=\"temp.customer_id\"\r\n                :items=\"customers\"\r\n                item-text=\"name\"\r\n                item-value=\"id\"\r\n                label=\"客户名称\"\r\n                placeholder=\"选择公司或单位\"\r\n                prepend-icon=\"mdi-database-search\"\r\n                @change=\"\r\n                  event => updateContactorsAndAddresses(event, temp.customer_id)\r\n                \"\r\n              ></v-autocomplete\r\n            ></v-col>\r\n\r\n            <v-col cols=\"12\" md=\"3\"\r\n              ><v-autocomplete\r\n                v-model=\"temp.address_id\"\r\n                :items=\"addresses\"\r\n                item-text=\"name\"\r\n                item-value=\"id\"\r\n                label=\"地址\"\r\n                placeholder=\"本次拜访的客户地址\"\r\n                prepend-icon=\"mdi-account-search-outline\"\r\n              ></v-autocomplete\r\n            ></v-col>\r\n\r\n            <!-- <v-col cols=\"12\" md=\"3\">\r\n              <v-autocomplete\r\n                v-model=\"temp.visittype_id\"\r\n                :items=\"visittypes\"\r\n                item-text=\"name\"\r\n                item-value=\"id\"\r\n                label=\"拜访类型\"\r\n                placeholder=\"\"\r\n                prepend-icon=\"mdi-account-search-outline\"\r\n              ></v-autocomplete>\r\n            </v-col> -->\r\n            <!-- 拜访类型对应了审批流程，并决定了审批节点的数量和对应的审批团队和人员 -->\r\n          </v-row>\r\n          <v-row>\r\n            <v-col\r\n              ><v-autocomplete\r\n                v-model=\"temp.contactorids\"\r\n                :items=\"contactors\"\r\n                item-text=\"name\"\r\n                item-value=\"id\"\r\n                label=\"联系人\"\r\n                placeholder=\"本次拜访接待人员\"\r\n                prepend-icon=\"mdi-account-search-outline\"\r\n                multiple\r\n                chips\r\n              ></v-autocomplete\r\n            ></v-col>\r\n          </v-row>\r\n\r\n          <v-text-field\r\n            v-model=\"temp.title\"\r\n            color=\"yellow darken-3\"\r\n            label=\"标题\"\r\n            hint=\"简述此次拜访目的和内容\"\r\n            required\r\n          ></v-text-field>\r\n          <v-textarea\r\n            v-model=\"temp.description\"\r\n            color=\"yellow darken-3\"\r\n            label=\"描述拜访经过和成果\"\r\n            hint=\"\"\r\n            required\r\n            auto-grow\r\n          ></v-textarea>\r\n\r\n          <v-row>\r\n            <v-spacer></v-spacer>\r\n            <span class=\"mt-6 mx-3\" style=\"font-size:14px\">\r\n              技术支持<span class=\"yanei ml-1 mr-7\">研一智控</span>\r\n            </span>\r\n          </v-row>\r\n          <v-card-actions>\r\n            <v-spacer></v-spacer>\r\n            <v-btn color=\"primary\" @click=\"cancelAddDialog\">取消</v-btn>\r\n            <v-btn color=\"primary\" @click=\"confirmAddDialog\">确认</v-btn>\r\n          </v-card-actions>\r\n        </div>\r\n      </v-card>\r\n    </v-container>\r\n  </v-dialog>\r\n</template>\r\n\r\n<script>\r\nimport { createVisit } from '@/api/visits'\r\nimport {\r\n  fetchCustomersList,\r\n  fetchContactorsListbyCustomerId,\r\n  fetchAddressesListbyCustomerId,\r\n  // fetchVisittypesList,\r\n} from '@/api/selections'\r\n\r\nexport default {\r\n  name: 'AddVisitDialog',\r\n  components: {},\r\n\r\n  data: () => ({\r\n    customers: [],\r\n    contactors: [],\r\n    addresses: [],\r\n    visittypes: [],\r\n    dialog: false,\r\n    editdialog: false,\r\n    temp: {\r\n      title: '',\r\n      description: '',\r\n      visittype_id: '',\r\n      customer_id: '',\r\n      address_id: '',\r\n      contactorids: [],\r\n    },\r\n  }),\r\n\r\n  watch: {\r\n    isUpdating(val) {\r\n      if (val) {\r\n        setTimeout(() => (this.isUpdating = false), 3000)\r\n      }\r\n    },\r\n  },\r\n  mounted() {},\r\n  created() {\r\n    this.getCustomersList()\r\n    // this.getVisittypesList()\r\n  },\r\n  methods: {\r\n    getCustomersList() {\r\n      fetchCustomersList().then(response => {\r\n        this.customers = response.data.items\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 1.5 * 1000)\r\n      })\r\n    },\r\n\r\n    getContactorsListbyCustomerId(id) {\r\n      fetchContactorsListbyCustomerId(id).then(response => {\r\n        this.contactors = response.data.items\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 1.5 * 1000)\r\n      })\r\n    },\r\n\r\n    getAddressesListbyCustomerId(id) {\r\n      fetchAddressesListbyCustomerId(id).then(response => {\r\n        this.addresses = response.data.items\r\n        setTimeout(() => {\r\n          this.listLoading = false\r\n        }, 1.5 * 1000)\r\n      })\r\n    },\r\n\r\n    // getVisittypesList() {\r\n    //   fetchVisittypesList().then(response => {\r\n    //     this.visittypes = response.data.items\r\n    //     setTimeout(() => {\r\n    //       this.listLoading = false\r\n    //     }, 1.5 * 1000)\r\n    //   })\r\n    // },\r\n\r\n    confirmAddDialog() {\r\n      const tempData = this.temp\r\n      createVisit(tempData).then(() => {\r\n        this.dialog = false\r\n        this.temp = {}\r\n        this.$parent.getList()\r\n      })\r\n    },\r\n\r\n    cancelAddDialog() {\r\n      this.dialog = false\r\n      this.temp = {}\r\n    },\r\n\r\n    updateContactorsAndAddresses(value, customerId) {\r\n      this.getContactorsListbyCustomerId(customerId)\r\n      this.getAddressesListbyCustomerId(customerId)\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\"></style>\r\n"]}]}